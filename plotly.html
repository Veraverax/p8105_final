<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>plotly.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About Us</a>
</li>
<li>
  <a href="plotly.html">Exploratory Graphs</a>
</li>
<li>
  <a href="regression.html">Regression Analysis</a>
</li>
<li>
  <a href="map.html">Maps</a>
</li>
<li>
  <a href="http://github.com/&lt;YOUR_GH_NAME&gt;/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<pre class="r"><code>library(tidyverse)
library(leaflet)
library(ggplot2)
library(plotly)
library(readxl)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = &quot;90%&quot;
)
theme_set(theme_minimal() + theme(legend.position = &quot;bottom&quot;))
options(
  ggplot2.continuous.colour = &quot;viridis&quot;,
  ggplot2.continuous.fill = &quot;viridis&quot;
)
scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d</code></pre>
<p>Read in wine data.</p>
<pre class="r"><code>wine_df = 
  read_csv(
  &quot;./wine_data/tidy/wine_all.csv&quot;)</code></pre>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Warning: Duplicated column names deduplicated: &#39;X1&#39; =&gt; &#39;X1_1&#39; [2]</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   X1 = col_double(),
##   X1_1 = col_double(),
##   country = col_character(),
##   description = col_character(),
##   designation = col_character(),
##   points = col_double(),
##   price = col_double(),
##   province = col_character(),
##   region_1 = col_character(),
##   taster_name = col_character(),
##   title = col_character(),
##   variety = col_character(),
##   winery = col_character(),
##   year = col_double(),
##   type = col_character()
## )</code></pre>
<pre class="r"><code>### remove region 2, taster twitter and missing values in region 1.

#wine_type &lt;- read_csv(&quot;./wine_data/winemag-data-130k-v2.csv&quot;) %&gt;% 
#            group_by(variety) %&gt;% 
#            count() %&gt;% 
#            arrange(desc(n)) %&gt;% 
#            as.tibble()</code></pre>
<p>Make a plot of distribution of price/rating by type</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(type),
         price &lt;= 200) %&gt;% 
  ggplot(aes(x = type, y = price, color = type)) +
  geom_violin()</code></pre>
<p><img src="plotly_files/figure-html/unnamed-chunk-3-1.png" width="90%" /></p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(type)) %&gt;% 
  rename(rating = points) %&gt;% 
  ggplot(aes(x = type, y = rating, color = type)) +
  geom_violin()</code></pre>
<p><img src="plotly_files/figure-html/unnamed-chunk-3-2.png" width="90%" /></p>
<p>Make a plot of distribution of price/rating by region</p>
<pre class="r"><code>y &lt;- list(
  title = &quot;Mean Price&quot;
)
wine_df %&gt;% 
  filter(!is.na(price)) %&gt;% 
  group_by(country) %&gt;% 
  summarise(mean = mean(price)) %&gt;% 
  mutate(country = fct_reorder(country, mean),
         mean = round(mean, 2),
        text_label=str_c(&quot;Country:&quot;, country, &quot;\nmean price:&quot;, mean)) %&gt;% 
  plot_ly(
  x = ~country, y = ~mean, color = ~country, text = ~text_label, 
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) %&gt;% 
  layout(yaxis = y)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## Warning: `arrange_()` is deprecated as of dplyr 0.7.0.
## Please use `arrange()` instead.
## See vignette(&#39;programming&#39;) for more help
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## Warning: Ignoring 1 observations</code></pre>
<div id="htmlwidget-88d2c5f542a4455629ad" style="width:90%;height:345.6px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-88d2c5f542a4455629ad">{"x":{"visdat":{"b2786be355cb":["function () ","plotlyVisDat"]},"cur_data":"b2786be355cb","attrs":{"b2786be355cb":{"x":{},"y":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Mean Price"},"xaxis":{"domain":[0,1],"automargin":true,"title":"country","type":"category","categoryorder":"array","categoryarray":["Ukraine","Bosnia and Herzegovina","India","Armenia","Bulgaria","Romania","Macedonia","Slovakia","Cyprus","Moldova","China","Peru","Georgia","Morocco","Chile","Greece","Luxembourg","Brazil","Czech Republic","Serbia","Argentina","Turkey","South Africa","Slovenia","Croatia","Portugal","Uruguay","Mexico","New Zealand","Spain","Lebanon","Austria","Israel","Australia","Canada","US","Italy","Hungary","France","Germany","England","Switzerland"]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Ukraine"],"y":[9.21],"text":"Country:Ukraine<br />mean price:9.21","type":"bar","name":"Ukraine","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bosnia and Herzegovina"],"y":[12.5],"text":"Country:Bosnia and Herzegovina<br />mean price:12.5","type":"bar","name":"Bosnia and Herzegovina","marker":{"color":"rgba(70,10,93,1)","line":{"color":"rgba(70,10,93,1)"}},"textfont":{"color":"rgba(70,10,93,1)"},"error_y":{"color":"rgba(70,10,93,1)"},"error_x":{"color":"rgba(70,10,93,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["India"],"y":[13.33],"text":"Country:India<br />mean price:13.33","type":"bar","name":"India","marker":{"color":"rgba(71,19,102,1)","line":{"color":"rgba(71,19,102,1)"}},"textfont":{"color":"rgba(71,19,102,1)"},"error_y":{"color":"rgba(71,19,102,1)"},"error_x":{"color":"rgba(71,19,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Armenia"],"y":[14.5],"text":"Country:Armenia<br />mean price:14.5","type":"bar","name":"Armenia","marker":{"color":"rgba(72,28,110,1)","line":{"color":"rgba(72,28,110,1)"}},"textfont":{"color":"rgba(72,28,110,1)"},"error_y":{"color":"rgba(72,28,110,1)"},"error_x":{"color":"rgba(72,28,110,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bulgaria"],"y":[14.65],"text":"Country:Bulgaria<br />mean price:14.65","type":"bar","name":"Bulgaria","marker":{"color":"rgba(72,36,117,1)","line":{"color":"rgba(72,36,117,1)"}},"textfont":{"color":"rgba(72,36,117,1)"},"error_y":{"color":"rgba(72,36,117,1)"},"error_x":{"color":"rgba(72,36,117,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Romania"],"y":[15.24],"text":"Country:Romania<br />mean price:15.24","type":"bar","name":"Romania","marker":{"color":"rgba(71,44,122,1)","line":{"color":"rgba(71,44,122,1)"}},"textfont":{"color":"rgba(71,44,122,1)"},"error_y":{"color":"rgba(71,44,122,1)"},"error_x":{"color":"rgba(71,44,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Macedonia"],"y":[15.58],"text":"Country:Macedonia<br />mean price:15.58","type":"bar","name":"Macedonia","marker":{"color":"rgba(70,51,127,1)","line":{"color":"rgba(70,51,127,1)"}},"textfont":{"color":"rgba(70,51,127,1)"},"error_y":{"color":"rgba(70,51,127,1)"},"error_x":{"color":"rgba(70,51,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Slovakia"],"y":[16],"text":"Country:Slovakia<br />mean price:16","type":"bar","name":"Slovakia","marker":{"color":"rgba(68,59,132,1)","line":{"color":"rgba(68,59,132,1)"}},"textfont":{"color":"rgba(68,59,132,1)"},"error_y":{"color":"rgba(68,59,132,1)"},"error_x":{"color":"rgba(68,59,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Cyprus"],"y":[16.27],"text":"Country:Cyprus<br />mean price:16.27","type":"bar","name":"Cyprus","marker":{"color":"rgba(65,66,135,1)","line":{"color":"rgba(65,66,135,1)"}},"textfont":{"color":"rgba(65,66,135,1)"},"error_y":{"color":"rgba(65,66,135,1)"},"error_x":{"color":"rgba(65,66,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Moldova"],"y":[16.75],"text":"Country:Moldova<br />mean price:16.75","type":"bar","name":"Moldova","marker":{"color":"rgba(62,73,137,1)","line":{"color":"rgba(62,73,137,1)"}},"textfont":{"color":"rgba(62,73,137,1)"},"error_y":{"color":"rgba(62,73,137,1)"},"error_x":{"color":"rgba(62,73,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["China"],"y":[18],"text":"Country:China<br />mean price:18","type":"bar","name":"China","marker":{"color":"rgba(60,80,139,1)","line":{"color":"rgba(60,80,139,1)"}},"textfont":{"color":"rgba(60,80,139,1)"},"error_y":{"color":"rgba(60,80,139,1)"},"error_x":{"color":"rgba(60,80,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Peru"],"y":[18.06],"text":"Country:Peru<br />mean price:18.06","type":"bar","name":"Peru","marker":{"color":"rgba(57,87,140,1)","line":{"color":"rgba(57,87,140,1)"}},"textfont":{"color":"rgba(57,87,140,1)"},"error_y":{"color":"rgba(57,87,140,1)"},"error_x":{"color":"rgba(57,87,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Georgia"],"y":[19.32],"text":"Country:Georgia<br />mean price:19.32","type":"bar","name":"Georgia","marker":{"color":"rgba(53,94,141,1)","line":{"color":"rgba(53,94,141,1)"}},"textfont":{"color":"rgba(53,94,141,1)"},"error_y":{"color":"rgba(53,94,141,1)"},"error_x":{"color":"rgba(53,94,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morocco"],"y":[19.5],"text":"Country:Morocco<br />mean price:19.5","type":"bar","name":"Morocco","marker":{"color":"rgba(50,100,142,1)","line":{"color":"rgba(50,100,142,1)"}},"textfont":{"color":"rgba(50,100,142,1)"},"error_y":{"color":"rgba(50,100,142,1)"},"error_x":{"color":"rgba(50,100,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Chile"],"y":[20.79],"text":"Country:Chile<br />mean price:20.79","type":"bar","name":"Chile","marker":{"color":"rgba(48,106,142,1)","line":{"color":"rgba(48,106,142,1)"}},"textfont":{"color":"rgba(48,106,142,1)"},"error_y":{"color":"rgba(48,106,142,1)"},"error_x":{"color":"rgba(48,106,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Greece"],"y":[22.36],"text":"Country:Greece<br />mean price:22.36","type":"bar","name":"Greece","marker":{"color":"rgba(45,112,142,1)","line":{"color":"rgba(45,112,142,1)"}},"textfont":{"color":"rgba(45,112,142,1)"},"error_y":{"color":"rgba(45,112,142,1)"},"error_x":{"color":"rgba(45,112,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Luxembourg"],"y":[23.33],"text":"Country:Luxembourg<br />mean price:23.33","type":"bar","name":"Luxembourg","marker":{"color":"rgba(42,118,142,1)","line":{"color":"rgba(42,118,142,1)"}},"textfont":{"color":"rgba(42,118,142,1)"},"error_y":{"color":"rgba(42,118,142,1)"},"error_x":{"color":"rgba(42,118,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Brazil"],"y":[23.77],"text":"Country:Brazil<br />mean price:23.77","type":"bar","name":"Brazil","marker":{"color":"rgba(40,124,142,1)","line":{"color":"rgba(40,124,142,1)"}},"textfont":{"color":"rgba(40,124,142,1)"},"error_y":{"color":"rgba(40,124,142,1)"},"error_x":{"color":"rgba(40,124,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic"],"y":[24.25],"text":"Country:Czech Republic<br />mean price:24.25","type":"bar","name":"Czech Republic","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Serbia"],"y":[24.5],"text":"Country:Serbia<br />mean price:24.5","type":"bar","name":"Serbia","marker":{"color":"rgba(36,135,142,1)","line":{"color":"rgba(36,135,142,1)"}},"textfont":{"color":"rgba(36,135,142,1)"},"error_y":{"color":"rgba(36,135,142,1)"},"error_x":{"color":"rgba(36,135,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Argentina"],"y":[24.51],"text":"Country:Argentina<br />mean price:24.51","type":"bar","name":"Argentina","marker":{"color":"rgba(34,141,141,1)","line":{"color":"rgba(34,141,141,1)"}},"textfont":{"color":"rgba(34,141,141,1)"},"error_y":{"color":"rgba(34,141,141,1)"},"error_x":{"color":"rgba(34,141,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Turkey"],"y":[24.63],"text":"Country:Turkey<br />mean price:24.63","type":"bar","name":"Turkey","marker":{"color":"rgba(32,147,140,1)","line":{"color":"rgba(32,147,140,1)"}},"textfont":{"color":"rgba(32,147,140,1)"},"error_y":{"color":"rgba(32,147,140,1)"},"error_x":{"color":"rgba(32,147,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Africa"],"y":[24.67],"text":"Country:South Africa<br />mean price:24.67","type":"bar","name":"South Africa","marker":{"color":"rgba(31,153,138,1)","line":{"color":"rgba(31,153,138,1)"}},"textfont":{"color":"rgba(31,153,138,1)"},"error_y":{"color":"rgba(31,153,138,1)"},"error_x":{"color":"rgba(31,153,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Slovenia"],"y":[24.81],"text":"Country:Slovenia<br />mean price:24.81","type":"bar","name":"Slovenia","marker":{"color":"rgba(31,159,136,1)","line":{"color":"rgba(31,159,136,1)"}},"textfont":{"color":"rgba(31,159,136,1)"},"error_y":{"color":"rgba(31,159,136,1)"},"error_x":{"color":"rgba(31,159,136,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Croatia"],"y":[25.45],"text":"Country:Croatia<br />mean price:25.45","type":"bar","name":"Croatia","marker":{"color":"rgba(32,164,134,1)","line":{"color":"rgba(32,164,134,1)"}},"textfont":{"color":"rgba(32,164,134,1)"},"error_y":{"color":"rgba(32,164,134,1)"},"error_x":{"color":"rgba(32,164,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Portugal"],"y":[26.22],"text":"Country:Portugal<br />mean price:26.22","type":"bar","name":"Portugal","marker":{"color":"rgba(36,170,131,1)","line":{"color":"rgba(36,170,131,1)"}},"textfont":{"color":"rgba(36,170,131,1)"},"error_y":{"color":"rgba(36,170,131,1)"},"error_x":{"color":"rgba(36,170,131,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Uruguay"],"y":[26.4],"text":"Country:Uruguay<br />mean price:26.4","type":"bar","name":"Uruguay","marker":{"color":"rgba(42,176,127,1)","line":{"color":"rgba(42,176,127,1)"}},"textfont":{"color":"rgba(42,176,127,1)"},"error_y":{"color":"rgba(42,176,127,1)"},"error_x":{"color":"rgba(42,176,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mexico"],"y":[26.79],"text":"Country:Mexico<br />mean price:26.79","type":"bar","name":"Mexico","marker":{"color":"rgba(50,182,122,1)","line":{"color":"rgba(50,182,122,1)"}},"textfont":{"color":"rgba(50,182,122,1)"},"error_y":{"color":"rgba(50,182,122,1)"},"error_x":{"color":"rgba(50,182,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Zealand"],"y":[26.93],"text":"Country:New Zealand<br />mean price:26.93","type":"bar","name":"New Zealand","marker":{"color":"rgba(59,187,117,1)","line":{"color":"rgba(59,187,117,1)"}},"textfont":{"color":"rgba(59,187,117,1)"},"error_y":{"color":"rgba(59,187,117,1)"},"error_x":{"color":"rgba(59,187,117,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Spain"],"y":[28.22],"text":"Country:Spain<br />mean price:28.22","type":"bar","name":"Spain","marker":{"color":"rgba(71,192,111,1)","line":{"color":"rgba(71,192,111,1)"}},"textfont":{"color":"rgba(71,192,111,1)"},"error_y":{"color":"rgba(71,192,111,1)"},"error_x":{"color":"rgba(71,192,111,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lebanon"],"y":[30.69],"text":"Country:Lebanon<br />mean price:30.69","type":"bar","name":"Lebanon","marker":{"color":"rgba(83,197,104,1)","line":{"color":"rgba(83,197,104,1)"}},"textfont":{"color":"rgba(83,197,104,1)"},"error_y":{"color":"rgba(83,197,104,1)"},"error_x":{"color":"rgba(83,197,104,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Austria"],"y":[30.76],"text":"Country:Austria<br />mean price:30.76","type":"bar","name":"Austria","marker":{"color":"rgba(96,202,96,1)","line":{"color":"rgba(96,202,96,1)"}},"textfont":{"color":"rgba(96,202,96,1)"},"error_y":{"color":"rgba(96,202,96,1)"},"error_x":{"color":"rgba(96,202,96,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel"],"y":[31.77],"text":"Country:Israel<br />mean price:31.77","type":"bar","name":"Israel","marker":{"color":"rgba(110,206,88,1)","line":{"color":"rgba(110,206,88,1)"}},"textfont":{"color":"rgba(110,206,88,1)"},"error_y":{"color":"rgba(110,206,88,1)"},"error_x":{"color":"rgba(110,206,88,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Australia"],"y":[35.44],"text":"Country:Australia<br />mean price:35.44","type":"bar","name":"Australia","marker":{"color":"rgba(125,210,80,1)","line":{"color":"rgba(125,210,80,1)"}},"textfont":{"color":"rgba(125,210,80,1)"},"error_y":{"color":"rgba(125,210,80,1)"},"error_x":{"color":"rgba(125,210,80,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada"],"y":[35.71],"text":"Country:Canada<br />mean price:35.71","type":"bar","name":"Canada","marker":{"color":"rgba(140,214,70,1)","line":{"color":"rgba(140,214,70,1)"}},"textfont":{"color":"rgba(140,214,70,1)"},"error_y":{"color":"rgba(140,214,70,1)"},"error_x":{"color":"rgba(140,214,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["US"],"y":[36.57],"text":"Country:US<br />mean price:36.57","type":"bar","name":"US","marker":{"color":"rgba(156,217,59,1)","line":{"color":"rgba(156,217,59,1)"}},"textfont":{"color":"rgba(156,217,59,1)"},"error_y":{"color":"rgba(156,217,59,1)"},"error_x":{"color":"rgba(156,217,59,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Italy"],"y":[39.66],"text":"Country:Italy<br />mean price:39.66","type":"bar","name":"Italy","marker":{"color":"rgba(173,220,48,1)","line":{"color":"rgba(173,220,48,1)"}},"textfont":{"color":"rgba(173,220,48,1)"},"error_y":{"color":"rgba(173,220,48,1)"},"error_x":{"color":"rgba(173,220,48,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Hungary"],"y":[40.65],"text":"Country:Hungary<br />mean price:40.65","type":"bar","name":"Hungary","marker":{"color":"rgba(189,223,38,1)","line":{"color":"rgba(189,223,38,1)"}},"textfont":{"color":"rgba(189,223,38,1)"},"error_y":{"color":"rgba(189,223,38,1)"},"error_x":{"color":"rgba(189,223,38,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["France"],"y":[41.14],"text":"Country:France<br />mean price:41.14","type":"bar","name":"France","marker":{"color":"rgba(206,225,29,1)","line":{"color":"rgba(206,225,29,1)"}},"textfont":{"color":"rgba(206,225,29,1)"},"error_y":{"color":"rgba(206,225,29,1)"},"error_x":{"color":"rgba(206,225,29,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Germany"],"y":[42.26],"text":"Country:Germany<br />mean price:42.26","type":"bar","name":"Germany","marker":{"color":"rgba(222,227,24,1)","line":{"color":"rgba(222,227,24,1)"}},"textfont":{"color":"rgba(222,227,24,1)"},"error_y":{"color":"rgba(222,227,24,1)"},"error_x":{"color":"rgba(222,227,24,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["England"],"y":[51.68],"text":"Country:England<br />mean price:51.68","type":"bar","name":"England","marker":{"color":"rgba(238,229,28,1)","line":{"color":"rgba(238,229,28,1)"}},"textfont":{"color":"rgba(238,229,28,1)"},"error_y":{"color":"rgba(238,229,28,1)"},"error_x":{"color":"rgba(238,229,28,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Switzerland"],"y":[85.29],"text":"Country:Switzerland<br />mean price:85.29","type":"bar","name":"Switzerland","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>y &lt;- list(
  title = &quot;Mean rating&quot;
)
wine_df %&gt;% 
  filter(!is.na(points)) %&gt;% 
  group_by(country) %&gt;% 
  summarise(mean = mean(points)) %&gt;% 
  mutate(country = fct_reorder(country, mean),
         mean = round(mean, 2),
        text_label=str_c(&quot;Country:&quot;, country, &quot;\nmean rating:&quot;, mean)) %&gt;% 
  plot_ly(
  x = ~country, y = ~mean, color = ~country, text = ~text_label, 
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) %&gt;% 
  layout(yaxis = y)</code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## Warning: Ignoring 1 observations</code></pre>
<p><div id="htmlwidget-e547c6674b0498dabb3e" style="width:90%;height:345.6px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e547c6674b0498dabb3e">{"x":{"visdat":{"b2781a15b9c3":["function () ","plotlyVisDat"]},"cur_data":"b2781a15b9c3","attrs":{"b2781a15b9c3":{"x":{},"y":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Mean rating"},"xaxis":{"domain":[0,1],"automargin":true,"title":"country","type":"category","categoryorder":"array","categoryarray":["Peru","Egypt","Ukraine","Brazil","Mexico","Romania","Chile","Bosnia and Herzegovina","Argentina","Uruguay","Macedonia","Slovakia","Cyprus","Moldova","Croatia","Czech Republic","Greece","Spain","Armenia","Serbia","Lebanon","Georgia","Bulgaria","South Africa","Slovenia","Turkey","Portugal","New Zealand","Israel","Italy","US","Morocco","Switzerland","Australia","Luxembourg","France","China","Hungary","Canada","Germany","Austria","India","England"]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Peru"],"y":[83.56],"text":"Country:Peru<br />mean rating:83.56","type":"bar","name":"Peru","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Egypt"],"y":[84],"text":"Country:Egypt<br />mean rating:84","type":"bar","name":"Egypt","marker":{"color":"rgba(70,10,93,1)","line":{"color":"rgba(70,10,93,1)"}},"textfont":{"color":"rgba(70,10,93,1)"},"error_y":{"color":"rgba(70,10,93,1)"},"error_x":{"color":"rgba(70,10,93,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ukraine"],"y":[84.07],"text":"Country:Ukraine<br />mean rating:84.07","type":"bar","name":"Ukraine","marker":{"color":"rgba(71,19,101,1)","line":{"color":"rgba(71,19,101,1)"}},"textfont":{"color":"rgba(71,19,101,1)"},"error_y":{"color":"rgba(71,19,101,1)"},"error_x":{"color":"rgba(71,19,101,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Brazil"],"y":[84.67],"text":"Country:Brazil<br />mean rating:84.67","type":"bar","name":"Brazil","marker":{"color":"rgba(72,27,109,1)","line":{"color":"rgba(72,27,109,1)"}},"textfont":{"color":"rgba(72,27,109,1)"},"error_y":{"color":"rgba(72,27,109,1)"},"error_x":{"color":"rgba(72,27,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mexico"],"y":[85.26],"text":"Country:Mexico<br />mean rating:85.26","type":"bar","name":"Mexico","marker":{"color":"rgba(72,35,116,1)","line":{"color":"rgba(72,35,116,1)"}},"textfont":{"color":"rgba(72,35,116,1)"},"error_y":{"color":"rgba(72,35,116,1)"},"error_x":{"color":"rgba(72,35,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Romania"],"y":[86.4],"text":"Country:Romania<br />mean rating:86.4","type":"bar","name":"Romania","marker":{"color":"rgba(71,43,122,1)","line":{"color":"rgba(71,43,122,1)"}},"textfont":{"color":"rgba(71,43,122,1)"},"error_y":{"color":"rgba(71,43,122,1)"},"error_x":{"color":"rgba(71,43,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Chile"],"y":[86.49],"text":"Country:Chile<br />mean rating:86.49","type":"bar","name":"Chile","marker":{"color":"rgba(70,50,126,1)","line":{"color":"rgba(70,50,126,1)"}},"textfont":{"color":"rgba(70,50,126,1)"},"error_y":{"color":"rgba(70,50,126,1)"},"error_x":{"color":"rgba(70,50,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bosnia and Herzegovina"],"y":[86.5],"text":"Country:Bosnia and Herzegovina<br />mean rating:86.5","type":"bar","name":"Bosnia and Herzegovina","marker":{"color":"rgba(68,58,131,1)","line":{"color":"rgba(68,58,131,1)"}},"textfont":{"color":"rgba(68,58,131,1)"},"error_y":{"color":"rgba(68,58,131,1)"},"error_x":{"color":"rgba(68,58,131,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Argentina"],"y":[86.71],"text":"Country:Argentina<br />mean rating:86.71","type":"bar","name":"Argentina","marker":{"color":"rgba(66,65,134,1)","line":{"color":"rgba(66,65,134,1)"}},"textfont":{"color":"rgba(66,65,134,1)"},"error_y":{"color":"rgba(66,65,134,1)"},"error_x":{"color":"rgba(66,65,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Uruguay"],"y":[86.75],"text":"Country:Uruguay<br />mean rating:86.75","type":"bar","name":"Uruguay","marker":{"color":"rgba(63,72,137,1)","line":{"color":"rgba(63,72,137,1)"}},"textfont":{"color":"rgba(63,72,137,1)"},"error_y":{"color":"rgba(63,72,137,1)"},"error_x":{"color":"rgba(63,72,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Macedonia"],"y":[86.83],"text":"Country:Macedonia<br />mean rating:86.83","type":"bar","name":"Macedonia","marker":{"color":"rgba(60,79,138,1)","line":{"color":"rgba(60,79,138,1)"}},"textfont":{"color":"rgba(60,79,138,1)"},"error_y":{"color":"rgba(60,79,138,1)"},"error_x":{"color":"rgba(60,79,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Slovakia"],"y":[87],"text":"Country:Slovakia<br />mean rating:87","type":"bar","name":"Slovakia","marker":{"color":"rgba(57,85,140,1)","line":{"color":"rgba(57,85,140,1)"}},"textfont":{"color":"rgba(57,85,140,1)"},"error_y":{"color":"rgba(57,85,140,1)"},"error_x":{"color":"rgba(57,85,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Cyprus"],"y":[87.18],"text":"Country:Cyprus<br />mean rating:87.18","type":"bar","name":"Cyprus","marker":{"color":"rgba(54,92,141,1)","line":{"color":"rgba(54,92,141,1)"}},"textfont":{"color":"rgba(54,92,141,1)"},"error_y":{"color":"rgba(54,92,141,1)"},"error_x":{"color":"rgba(54,92,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Moldova"],"y":[87.2],"text":"Country:Moldova<br />mean rating:87.2","type":"bar","name":"Moldova","marker":{"color":"rgba(51,98,141,1)","line":{"color":"rgba(51,98,141,1)"}},"textfont":{"color":"rgba(51,98,141,1)"},"error_y":{"color":"rgba(51,98,141,1)"},"error_x":{"color":"rgba(51,98,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Croatia"],"y":[87.22],"text":"Country:Croatia<br />mean rating:87.22","type":"bar","name":"Croatia","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic"],"y":[87.25],"text":"Country:Czech Republic<br />mean rating:87.25","type":"bar","name":"Czech Republic","marker":{"color":"rgba(46,110,142,1)","line":{"color":"rgba(46,110,142,1)"}},"textfont":{"color":"rgba(46,110,142,1)"},"error_y":{"color":"rgba(46,110,142,1)"},"error_x":{"color":"rgba(46,110,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Greece"],"y":[87.28],"text":"Country:Greece<br />mean rating:87.28","type":"bar","name":"Greece","marker":{"color":"rgba(44,115,142,1)","line":{"color":"rgba(44,115,142,1)"}},"textfont":{"color":"rgba(44,115,142,1)"},"error_y":{"color":"rgba(44,115,142,1)"},"error_x":{"color":"rgba(44,115,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Spain"],"y":[87.29],"text":"Country:Spain<br />mean rating:87.29","type":"bar","name":"Spain","marker":{"color":"rgba(41,121,142,1)","line":{"color":"rgba(41,121,142,1)"}},"textfont":{"color":"rgba(41,121,142,1)"},"error_y":{"color":"rgba(41,121,142,1)"},"error_x":{"color":"rgba(41,121,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Armenia"],"y":[87.5],"text":"Country:Armenia<br />mean rating:87.5","type":"bar","name":"Armenia","marker":{"color":"rgba(39,127,142,1)","line":{"color":"rgba(39,127,142,1)"}},"textfont":{"color":"rgba(39,127,142,1)"},"error_y":{"color":"rgba(39,127,142,1)"},"error_x":{"color":"rgba(39,127,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Serbia"],"y":[87.5],"text":"Country:Serbia<br />mean rating:87.5","type":"bar","name":"Serbia","marker":{"color":"rgba(37,132,142,1)","line":{"color":"rgba(37,132,142,1)"}},"textfont":{"color":"rgba(37,132,142,1)"},"error_y":{"color":"rgba(37,132,142,1)"},"error_x":{"color":"rgba(37,132,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lebanon"],"y":[87.69],"text":"Country:Lebanon<br />mean rating:87.69","type":"bar","name":"Lebanon","marker":{"color":"rgba(35,138,141,1)","line":{"color":"rgba(35,138,141,1)"}},"textfont":{"color":"rgba(35,138,141,1)"},"error_y":{"color":"rgba(35,138,141,1)"},"error_x":{"color":"rgba(35,138,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Georgia"],"y":[87.69],"text":"Country:Georgia<br />mean rating:87.69","type":"bar","name":"Georgia","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bulgaria"],"y":[87.94],"text":"Country:Bulgaria<br />mean rating:87.94","type":"bar","name":"Bulgaria","marker":{"color":"rgba(31,150,139,1)","line":{"color":"rgba(31,150,139,1)"}},"textfont":{"color":"rgba(31,150,139,1)"},"error_y":{"color":"rgba(31,150,139,1)"},"error_x":{"color":"rgba(31,150,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Africa"],"y":[88.06],"text":"Country:South Africa<br />mean rating:88.06","type":"bar","name":"South Africa","marker":{"color":"rgba(30,156,137,1)","line":{"color":"rgba(30,156,137,1)"}},"textfont":{"color":"rgba(30,156,137,1)"},"error_y":{"color":"rgba(30,156,137,1)"},"error_x":{"color":"rgba(30,156,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Slovenia"],"y":[88.07],"text":"Country:Slovenia<br />mean rating:88.07","type":"bar","name":"Slovenia","marker":{"color":"rgba(31,161,135,1)","line":{"color":"rgba(31,161,135,1)"}},"textfont":{"color":"rgba(31,161,135,1)"},"error_y":{"color":"rgba(31,161,135,1)"},"error_x":{"color":"rgba(31,161,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Turkey"],"y":[88.09],"text":"Country:Turkey<br />mean rating:88.09","type":"bar","name":"Turkey","marker":{"color":"rgba(34,167,133,1)","line":{"color":"rgba(34,167,133,1)"}},"textfont":{"color":"rgba(34,167,133,1)"},"error_y":{"color":"rgba(34,167,133,1)"},"error_x":{"color":"rgba(34,167,133,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Portugal"],"y":[88.25],"text":"Country:Portugal<br />mean rating:88.25","type":"bar","name":"Portugal","marker":{"color":"rgba(38,173,129,1)","line":{"color":"rgba(38,173,129,1)"}},"textfont":{"color":"rgba(38,173,129,1)"},"error_y":{"color":"rgba(38,173,129,1)"},"error_x":{"color":"rgba(38,173,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Zealand"],"y":[88.3],"text":"Country:New Zealand<br />mean rating:88.3","type":"bar","name":"New Zealand","marker":{"color":"rgba(45,178,125,1)","line":{"color":"rgba(45,178,125,1)"}},"textfont":{"color":"rgba(45,178,125,1)"},"error_y":{"color":"rgba(45,178,125,1)"},"error_x":{"color":"rgba(45,178,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel"],"y":[88.47],"text":"Country:Israel<br />mean rating:88.47","type":"bar","name":"Israel","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Italy"],"y":[88.56],"text":"Country:Italy<br />mean rating:88.56","type":"bar","name":"Italy","marker":{"color":"rgba(63,188,115,1)","line":{"color":"rgba(63,188,115,1)"}},"textfont":{"color":"rgba(63,188,115,1)"},"error_y":{"color":"rgba(63,188,115,1)"},"error_x":{"color":"rgba(63,188,115,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["US"],"y":[88.56],"text":"Country:US<br />mean rating:88.56","type":"bar","name":"US","marker":{"color":"rgba(74,193,109,1)","line":{"color":"rgba(74,193,109,1)"}},"textfont":{"color":"rgba(74,193,109,1)"},"error_y":{"color":"rgba(74,193,109,1)"},"error_x":{"color":"rgba(74,193,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morocco"],"y":[88.57],"text":"Country:Morocco<br />mean rating:88.57","type":"bar","name":"Morocco","marker":{"color":"rgba(86,198,103,1)","line":{"color":"rgba(86,198,103,1)"}},"textfont":{"color":"rgba(86,198,103,1)"},"error_y":{"color":"rgba(86,198,103,1)"},"error_x":{"color":"rgba(86,198,103,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Switzerland"],"y":[88.57],"text":"Country:Switzerland<br />mean rating:88.57","type":"bar","name":"Switzerland","marker":{"color":"rgba(100,203,95,1)","line":{"color":"rgba(100,203,95,1)"}},"textfont":{"color":"rgba(100,203,95,1)"},"error_y":{"color":"rgba(100,203,95,1)"},"error_x":{"color":"rgba(100,203,95,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Australia"],"y":[88.58],"text":"Country:Australia<br />mean rating:88.58","type":"bar","name":"Australia","marker":{"color":"rgba(113,207,87,1)","line":{"color":"rgba(113,207,87,1)"}},"textfont":{"color":"rgba(113,207,87,1)"},"error_y":{"color":"rgba(113,207,87,1)"},"error_x":{"color":"rgba(113,207,87,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Luxembourg"],"y":[88.67],"text":"Country:Luxembourg<br />mean rating:88.67","type":"bar","name":"Luxembourg","marker":{"color":"rgba(128,211,78,1)","line":{"color":"rgba(128,211,78,1)"}},"textfont":{"color":"rgba(128,211,78,1)"},"error_y":{"color":"rgba(128,211,78,1)"},"error_x":{"color":"rgba(128,211,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["France"],"y":[88.85],"text":"Country:France<br />mean rating:88.85","type":"bar","name":"France","marker":{"color":"rgba(143,214,68,1)","line":{"color":"rgba(143,214,68,1)"}},"textfont":{"color":"rgba(143,214,68,1)"},"error_y":{"color":"rgba(143,214,68,1)"},"error_x":{"color":"rgba(143,214,68,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["China"],"y":[89],"text":"Country:China<br />mean rating:89","type":"bar","name":"China","marker":{"color":"rgba(159,218,58,1)","line":{"color":"rgba(159,218,58,1)"}},"textfont":{"color":"rgba(159,218,58,1)"},"error_y":{"color":"rgba(159,218,58,1)"},"error_x":{"color":"rgba(159,218,58,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Hungary"],"y":[89.19],"text":"Country:Hungary<br />mean rating:89.19","type":"bar","name":"Hungary","marker":{"color":"rgba(175,221,47,1)","line":{"color":"rgba(175,221,47,1)"}},"textfont":{"color":"rgba(175,221,47,1)"},"error_y":{"color":"rgba(175,221,47,1)"},"error_x":{"color":"rgba(175,221,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada"],"y":[89.37],"text":"Country:Canada<br />mean rating:89.37","type":"bar","name":"Canada","marker":{"color":"rgba(191,223,37,1)","line":{"color":"rgba(191,223,37,1)"}},"textfont":{"color":"rgba(191,223,37,1)"},"error_y":{"color":"rgba(191,223,37,1)"},"error_x":{"color":"rgba(191,223,37,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Germany"],"y":[89.85],"text":"Country:Germany<br />mean rating:89.85","type":"bar","name":"Germany","marker":{"color":"rgba(207,225,28,1)","line":{"color":"rgba(207,225,28,1)"}},"textfont":{"color":"rgba(207,225,28,1)"},"error_y":{"color":"rgba(207,225,28,1)"},"error_x":{"color":"rgba(207,225,28,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Austria"],"y":[90.1],"text":"Country:Austria<br />mean rating:90.1","type":"bar","name":"Austria","marker":{"color":"rgba(223,227,24,1)","line":{"color":"rgba(223,227,24,1)"}},"textfont":{"color":"rgba(223,227,24,1)"},"error_y":{"color":"rgba(223,227,24,1)"},"error_x":{"color":"rgba(223,227,24,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["India"],"y":[90.22],"text":"Country:India<br />mean rating:90.22","type":"bar","name":"India","marker":{"color":"rgba(239,229,28,1)","line":{"color":"rgba(239,229,28,1)"}},"textfont":{"color":"rgba(239,229,28,1)"},"error_y":{"color":"rgba(239,229,28,1)"},"error_x":{"color":"rgba(239,229,28,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["England"],"y":[91.58],"text":"Country:England<br />mean rating:91.58","type":"bar","name":"England","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script> Even though Switzerland has the highest priced wine, the average ratings is only ranked at 11.</p>
<p>Make plots of ratings/price by year by wine type.</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(points),
         !is.na(type),
         year &gt; 2000) %&gt;% 
  group_by(year,type) %&gt;% 
  summarise(mean = mean(points)) %&gt;% 
  mutate(mean = round(mean, 2)) %&gt;% 
  ggplot(aes(x = year, y = mean, color = type))+
  geom_point()+
  geom_line() +
  labs(y = &quot;Mean rating&quot;,
      x = &quot;Year&quot;,
      title = &quot;change in mean ratings by wine type in 21 century&quot;)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;year&#39; (override with `.groups` argument)</code></pre>
<p><img src="plotly_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(price),
         !is.na(type),
         year &gt; 2000) %&gt;% 
  group_by(year,type) %&gt;% 
  summarise(mean = mean(price)) %&gt;% 
  mutate(mean = round(mean, 2)) %&gt;% 
  ggplot(aes(x = year, y = mean, color = type))+
  geom_point()+
  geom_line() +
  labs(y = &quot;Mean price&quot;,
      x = &quot;Year&quot;,
      title = &quot;change in mean price by wine type in 21 century&quot;)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;year&#39; (override with `.groups` argument)</code></pre>
<p><img src="plotly_files/figure-html/unnamed-chunk-5-2.png" width="90%" /></p>
<p>Make plots of ratings by taster.</p>
<pre class="r"><code>y &lt;- list(
  title = &quot;Mean ratings&quot;
)

  wine_df %&gt;% 
  filter(!is.na(points)) %&gt;% 
  group_by(taster_name) %&gt;% 
  summarise(mean = mean(points)) %&gt;% 
  mutate(taster_name = fct_reorder(taster_name, mean),
         mean = round(mean, 2),
        text_label=str_c(&quot;Taster:&quot;, taster_name, &quot;\nmean rating:&quot;, mean)) %&gt;% 
  plot_ly(
  x = ~taster_name, y = ~mean, color = ~taster_name, text = ~text_label, 
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) %&gt;% 
  layout(yaxis = y) </code></pre>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## Warning: Ignoring 1 observations</code></pre>
<div id="htmlwidget-b1b1c0e63ba7da1d81eb" style="width:90%;height:345.6px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b1b1c0e63ba7da1d81eb">{"x":{"visdat":{"b278335433e6":["function () ","plotlyVisDat"]},"cur_data":"b278335433e6","attrs":{"b278335433e6":{"x":{},"y":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Mean ratings"},"xaxis":{"domain":[0,1],"automargin":true,"title":"taster_name","type":"category","categoryorder":"array","categoryarray":["Alexander Peartree","Carrie Dykes","Susan Kostrzewa","Fiona Adams","Michael Schachner","Lauren Buzzeo","Christina Pickard","Jeff Jenssen","Anna Lee C. Iijima","Joe Czerwinski","Jim Gordon","Roger Voss","Sean P. Sullivan","Kerin O’Keefe","Paul Gregutt","Mike DeSimone","Virginie Boone","Matt Kettmann","Anne Krebiehl MW"]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Alexander Peartree"],"y":[85.86],"text":"Taster:Alexander Peartree<br />mean rating:85.86","type":"bar","name":"Alexander Peartree","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Carrie Dykes"],"y":[86.4],"text":"Taster:Carrie Dykes<br />mean rating:86.4","type":"bar","name":"Carrie Dykes","marker":{"color":"rgba(72,22,104,1)","line":{"color":"rgba(72,22,104,1)"}},"textfont":{"color":"rgba(72,22,104,1)"},"error_y":{"color":"rgba(72,22,104,1)"},"error_x":{"color":"rgba(72,22,104,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Susan Kostrzewa"],"y":[86.61],"text":"Taster:Susan Kostrzewa<br />mean rating:86.61","type":"bar","name":"Susan Kostrzewa","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Fiona Adams"],"y":[86.89],"text":"Taster:Fiona Adams<br />mean rating:86.89","type":"bar","name":"Fiona Adams","marker":{"color":"rgba(68,58,131,1)","line":{"color":"rgba(68,58,131,1)"}},"textfont":{"color":"rgba(68,58,131,1)"},"error_y":{"color":"rgba(68,58,131,1)"},"error_x":{"color":"rgba(68,58,131,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michael Schachner"],"y":[86.91],"text":"Taster:Michael Schachner<br />mean rating:86.91","type":"bar","name":"Michael Schachner","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lauren Buzzeo"],"y":[87.74],"text":"Taster:Lauren Buzzeo<br />mean rating:87.74","type":"bar","name":"Lauren Buzzeo","marker":{"color":"rgba(55,90,140,1)","line":{"color":"rgba(55,90,140,1)"}},"textfont":{"color":"rgba(55,90,140,1)"},"error_y":{"color":"rgba(55,90,140,1)"},"error_x":{"color":"rgba(55,90,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Christina Pickard"],"y":[87.83],"text":"Taster:Christina Pickard<br />mean rating:87.83","type":"bar","name":"Christina Pickard","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jeff Jenssen"],"y":[88.32],"text":"Taster:Jeff Jenssen<br />mean rating:88.32","type":"bar","name":"Jeff Jenssen","marker":{"color":"rgba(43,117,142,1)","line":{"color":"rgba(43,117,142,1)"}},"textfont":{"color":"rgba(43,117,142,1)"},"error_y":{"color":"rgba(43,117,142,1)"},"error_x":{"color":"rgba(43,117,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Anna Lee C. Iijima"],"y":[88.42],"text":"Taster:Anna Lee C. Iijima<br />mean rating:88.42","type":"bar","name":"Anna Lee C. Iijima","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Joe Czerwinski"],"y":[88.54],"text":"Taster:Joe Czerwinski<br />mean rating:88.54","type":"bar","name":"Joe Czerwinski","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jim Gordon"],"y":[88.63],"text":"Taster:Jim Gordon<br />mean rating:88.63","type":"bar","name":"Jim Gordon","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Roger Voss"],"y":[88.71],"text":"Taster:Roger Voss<br />mean rating:88.71","type":"bar","name":"Roger Voss","marker":{"color":"rgba(37,171,130,1)","line":{"color":"rgba(37,171,130,1)"}},"textfont":{"color":"rgba(37,171,130,1)"},"error_y":{"color":"rgba(37,171,130,1)"},"error_x":{"color":"rgba(37,171,130,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sean P. Sullivan"],"y":[88.76],"text":"Taster:Sean P. Sullivan<br />mean rating:88.76","type":"bar","name":"Sean P. Sullivan","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kerin O’Keefe"],"y":[88.87],"text":"Taster:Kerin O’Keefe<br />mean rating:88.87","type":"bar","name":"Kerin O’Keefe","marker":{"color":"rgba(78,195,107,1)","line":{"color":"rgba(78,195,107,1)"}},"textfont":{"color":"rgba(78,195,107,1)"},"error_y":{"color":"rgba(78,195,107,1)"},"error_x":{"color":"rgba(78,195,107,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Paul Gregutt"],"y":[89.08],"text":"Taster:Paul Gregutt<br />mean rating:89.08","type":"bar","name":"Paul Gregutt","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mike DeSimone"],"y":[89.1],"text":"Taster:Mike DeSimone<br />mean rating:89.1","type":"bar","name":"Mike DeSimone","marker":{"color":"rgba(143,214,68,1)","line":{"color":"rgba(143,214,68,1)"}},"textfont":{"color":"rgba(143,214,68,1)"},"error_y":{"color":"rgba(143,214,68,1)"},"error_x":{"color":"rgba(143,214,68,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginie Boone"],"y":[89.21],"text":"Taster:Virginie Boone<br />mean rating:89.21","type":"bar","name":"Virginie Boone","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Matt Kettmann"],"y":[90.01],"text":"Taster:Matt Kettmann<br />mean rating:90.01","type":"bar","name":"Matt Kettmann","marker":{"color":"rgba(218,227,25,1)","line":{"color":"rgba(218,227,25,1)"}},"textfont":{"color":"rgba(218,227,25,1)"},"error_y":{"color":"rgba(218,227,25,1)"},"error_x":{"color":"rgba(218,227,25,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Anne Krebiehl MW"],"y":[90.56],"text":"Taster:Anne Krebiehl MW<br />mean rating:90.56","type":"bar","name":"Anne Krebiehl MW","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>who rates the highest price wine? (greater than $800)</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(price &gt;= 800,
         !is.na(taster_name)) %&gt;% 
  group_by(taster_name) %&gt;% 
  count()</code></pre>
<pre><code>## # A tibble: 5 x 2
## # Groups:   taster_name [5]
##   taster_name          n
##   &lt;chr&gt;            &lt;int&gt;
## 1 Anne Krebiehl MW     1
## 2 Joe Czerwinski       3
## 3 Kerin O’Keefe        1
## 4 Matt Kettmann        1
## 5 Roger Voss          24</code></pre>
<p>Most of the most expensive wine are rated by Roger Voss.</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(taster_name)) %&gt;% 
  group_by(taster_name) %&gt;% 
  count() %&gt;% 
  arrange(desc(n)) %&gt;% 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">taster_name</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Roger Voss</td>
<td align="right">25514</td>
</tr>
<tr class="even">
<td align="left">Michael Schachner</td>
<td align="right">15134</td>
</tr>
<tr class="odd">
<td align="left">Kerin O’Keefe</td>
<td align="right">10776</td>
</tr>
<tr class="even">
<td align="left">Virginie Boone</td>
<td align="right">9537</td>
</tr>
<tr class="odd">
<td align="left">Paul Gregutt</td>
<td align="right">9532</td>
</tr>
<tr class="even">
<td align="left">Matt Kettmann</td>
<td align="right">6332</td>
</tr>
<tr class="odd">
<td align="left">Joe Czerwinski</td>
<td align="right">5147</td>
</tr>
<tr class="even">
<td align="left">Sean P. Sullivan</td>
<td align="right">4966</td>
</tr>
<tr class="odd">
<td align="left">Anna Lee C. Iijima</td>
<td align="right">4415</td>
</tr>
<tr class="even">
<td align="left">Jim Gordon</td>
<td align="right">4177</td>
</tr>
<tr class="odd">
<td align="left">Anne Krebiehl MW</td>
<td align="right">3685</td>
</tr>
<tr class="even">
<td align="left">Lauren Buzzeo</td>
<td align="right">1835</td>
</tr>
<tr class="odd">
<td align="left">Susan Kostrzewa</td>
<td align="right">1085</td>
</tr>
<tr class="even">
<td align="left">Mike DeSimone</td>
<td align="right">514</td>
</tr>
<tr class="odd">
<td align="left">Jeff Jenssen</td>
<td align="right">491</td>
</tr>
<tr class="even">
<td align="left">Alexander Peartree</td>
<td align="right">415</td>
</tr>
<tr class="odd">
<td align="left">Carrie Dykes</td>
<td align="right">139</td>
</tr>
<tr class="even">
<td align="left">Fiona Adams</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">Christina Pickard</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p>Roger Voss rates most number of wine at WineEthusiast Magazine.</p>
<p>Get the winery which has the top average ratings wine.</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(winery)) %&gt;% 
  group_by(winery,country) %&gt;% 
  summarise(mean = mean(points)) %&gt;% 
  arrange(desc(mean)) %&gt;% 
  top_n(10)</code></pre>
<pre><code>## `summarise()` regrouping output by &#39;winery&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Selecting by mean</code></pre>
<pre><code>## # A tibble: 16,961 x 3
## # Groups:   winery [16,757]
##    winery                country    mean
##    &lt;chr&gt;                 &lt;chr&gt;     &lt;dbl&gt;
##  1 Araujo                US         98  
##  2 Gandona               US         97  
##  3 J.L. Chave            France     97  
##  4 Ovid                  US         97  
##  5 Standish              Australia  97  
##  6 Salon                 France     96.8
##  7 Tenuta dell&#39;Ornellaia Italy      96.7
##  8 Château Pétrus        France     96.7
##  9 Barons de Rothschild  France     96  
## 10 Bryant Family         US         96  
## # … with 16,951 more rows</code></pre>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
