---
title: "Word Cloud"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r}
library(tidyverse)
library(tidytext)
library(RColorBrewer)
library(tidytext)
library(wordcloud2)
library(knitr)
library(DT)
```

Read in tidy wine data.

```{r extract_year_function}
red_df =  read_csv("./wine_data/tidy/wine_red.csv")
```

* find out frequency of wine notes from description and make visualization - to each type
  ** red
  ** white
  ** rose
  ** sparkling
  ** dessert
```{r}
# reshape the .txt data frame into one column
red_word = 
  red_df %>% 
  select(description) %>% 
  unnest_tokens(word, description) %>% 
  dplyr::count(word, sort = TRUE) %>% 
  ungroup()

# remove uninformative words
data("stop_words")
red_word = 
  anti_join(red_word, stop_words)
# remove more uninformative words in our study
other_meaningless <- data.frame(word = c("wine","drink","flavors","notes","finish", "blend", "palate", "cabernet"))
red_word = 
  red_word %>% 
  anti_join(other_meaningless, by = "word")
# remove numbers
nums = red_word %>% filter(str_detect(word, "^[0-9]")) %>% select(word) %>% unique()
red_word = red_word %>% 
  anti_join(nums, by = "word")
# check the top 10 words
red_word %>% head(10)

# plot word cloud using image of the wine bottle as a mask
red_word %>%
  wordcloud2(figPath = "./image/wine_bottle.png", size = 0.58, color = 'red', backgroundColor = "white")

# searchable data table for words
# red_word %>%
#  DT::datatable()
```
  
  ** filter by higher ratings
