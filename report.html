<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Report</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About Us</a>
</li>
<li>
  <a href="plotly.html">Exploratory Graphs</a>
</li>
<li>
  <a href="regression.html">Regression Analysis</a>
</li>
<li>
  <a href="mapping.html">Maps</a>
</li>
<li>
  <a href="https://github.com/Veraverax/p8105_final/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Report</h1>

</div>


<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(leaflet)
library(ggplot2)
library(plotly)</code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<pre class="r"><code>library(readxl)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = &quot;90%&quot;
)
theme_set(theme_minimal() + theme(legend.position = &quot;bottom&quot;))
options(
  ggplot2.continuous.colour = &quot;viridis&quot;,
  ggplot2.continuous.fill = &quot;viridis&quot;
)
scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d</code></pre>
<pre class="r"><code>wine_df = 
  read_csv(
  &quot;./wine_data/tidy/wine_all.csv&quot;)</code></pre>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   X1 = col_double(),
##   country = col_character(),
##   description = col_character(),
##   designation = col_character(),
##   points = col_double(),
##   price = col_double(),
##   province = col_character(),
##   region_1 = col_character(),
##   taster_name = col_character(),
##   title = col_character(),
##   variety = col_character(),
##   winery = col_character(),
##   year = col_double(),
##   new_world = col_logical(),
##   old_world = col_logical(),
##   type = col_character()
## )</code></pre>
<pre class="r"><code>### remove region 2, taster twitter and missing values in region 1.

#wine_type &lt;- read_csv(&quot;./wine_data/winemag-data-130k-v2.csv&quot;) %&gt;% 
#            group_by(variety) %&gt;% 
#            count() %&gt;% 
#            arrange(desc(n)) %&gt;% 
#            as.tibble()</code></pre>
<p>Your report should include the following topics. Depending on your project type the amount of discussion you devote to each of them will vary:</p>
<div id="motivation" class="section level1">
<h1>Motivation:</h1>
<p>This dataset offers us a great opportunity to explore what factors are associated with wine ratings. We hope to conduct regression analysis of the wine rating and price based on location/grape type/notes/region and see if there are significant difference among these categorical predictors. The regression model would help customers estimate and predict wine rating with a series of wine characteristics. We also want to provide people with a interactive website to visualize wine ratings and prices.</p>
</div>
<div id="related-work" class="section level1">
<h1>Related work:</h1>
<p>Anything that inspired you, such as a paper, a web site, or something we discussed in class.</p>
</div>
<div id="initial-questions" class="section level1">
<h1>Initial questions:</h1>
<p>We are trying to answer some questions from exploratory analysis. To understand the information that customers could get from the ratings, price among different wine type and region, we want to answer the following questions:</p>
<ol style="list-style-type: decimal">
<li><p>What is the distribution of prices among four types of wine? Is at least one wine type’s price different from the others?</p></li>
<li><p>What is the distribution of ratings among four types of wine? Is at least one wine type’s rating different from the others?</p></li>
<li><p>What is the average price of wines at different regions? Which region has the highest average price wine?</p></li>
<li><p>What is the average rating of wines at different regions? Which region has the highest average rating?</p></li>
<li><p>What is the trend of price over time among 4 types of wine?</p></li>
<li><p>What is the trend of ratings over time among 4 types of wine?</p></li>
<li><p>What is the average ratings by each tasters? Who rates the highest price wine? Who reviews the largest number of wines?</p></li>
<li><p>Which winery has the top average ratings wine?</p></li>
<li><p>Is there any differences in prices between new world and old world wine?</p></li>
<li><p>Is there any differences in ratings between new world and old world wine?</p></li>
<li><p>Wine distribution worldwide:</p></li>
</ol>
<ul>
<li>correspond to the world map</li>
<li>correspond to the word cloud</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Linear model - predict Based on the information we have about a bottle of wine, how can we predict the price and points?</li>
</ol>
<p>What questions are you trying to answer? How did these questions evolve over the course of the project? What new questions did you consider in the course of your analysis?</p>
<ol start="4" style="list-style-type: decimal">
<li>Didn’t address yet - interactive plot (shiny)</li>
</ol>
<ul>
<li>filter by price</li>
<li>filter by country</li>
<li>filter by wine type</li>
</ul>
</div>
<div id="data" class="section level1">
<h1>Data:</h1>
<p>Source, scraping method, cleaning, etc.</p>
<p>The data for this project is downloaded from <a href="https://www.kaggle.com/zynicide/wine-reviews">Kaggle</a>. It was scraped on November 22nd, 2017 from the <a href="https://www.winemag.com/?s=&amp;drink_type=wine">WineEnthusiast Rating database</a>. Wine Enthusiast is a magazine provide information on wine quality, wine variety, tours and events—in short - everything about wine.</p>
<p>This dataset contains 129971 wine reviews with variety, location, winery, price, description and reviewer information. There is much information on description and title on each wine. We had extracted from the text of useful information such as the year the wine was made in and the characteristics of the taste.</p>
<div id="variables-of-interest" class="section level3">
<h3><em>Variables of interest</em></h3>
<pre class="r"><code>## Vera in charge of editing this sector</code></pre>
<div id="outcomes" class="section level5">
<h5><strong>Outcomes</strong></h5>
<ul>
<li><code>price</code> . Count of evictions (or eviction filings) per year at the census tract level.</li>
<li><code>rating</code>. Calculated using number of evictions or eviction filings divided by the number of <code>renter_occupied_households</code> and multiplied by 100, to be interpreted as a percentage.</li>
</ul>
</div>
<div id="candidate-predictors" class="section level5">
<h5><strong>Candidate Predictors</strong></h5>
<ul>
<li><code>years_since_2010</code>. Since our data range from 2010 to 2016, and we did not want to assume a constant effect of time, we included year as a set of indicator variables in all models except our empty model (see below).</li>
<li><code>hisp</code>. Percent of population (at census tract level, for all race/ethnicity variables) that self-report Hispanic ethnicity.</li>
<li><code>white</code>. Percent self-reporting White race.</li>
<li><code>black</code>. Percent self-reporting Black race.</li>
<li><code>asian</code>. Percent self-reporting Asian race.</li>
<li><code>aian</code>. Percent self-reporting American Indian / Alaska Native race.</li>
<li><code>nhpi</code>. Percent self-reporting Native Hawaiian / Pacific Islander race.</li>
<li><code>other</code>. Percent self-reporting other race.</li>
<li><code>rent_burden</code>. Average percent of income spent on rent.</li>
<li><code>density</code>. Population density.</li>
<li><code>pct_eng</code>. Percent of population who speak English less than ‘Very Well’. This is interpreted as a proxy for percent English as a second language (ESL) speakers.</li>
<li><code>median_household_income</code>. Median census tract household income in USD.</li>
<li><code>poverty_rate</code>. Percent living below Federal Poverty Line (FPL).</li>
<li><code>median_gross_rent</code>. Median census tract gross rent in USD.</li>
<li><code>pct_renter_occupied</code>. Percent of census tract occupied by renters.</li>
<li><code>median_property_value</code>. Median census tract property value in USD.</li>
<li><code>family_size</code>. Average family size in census tract.</li>
<li><code>pct_fam_households</code>. Percentage of census tract households that contain families.</li>
</ul>
<p>At first, the dataset contains more than 50 wine varieties and it is hard to get useful information. Therefore, we had categorized all varieties to four types of wine: red, white, rose and sparkling according to the following infographics on <a href="https://winefolly.com/deep-dive/different-types-of-wine/">Wine Folly</a>.</p>
</div>
</div>
</div>
<div id="exploratory-analysis" class="section level1">
<h1>Exploratory analysis:</h1>
<div id="descriptive-statistics" class="section level2">
<h2>Descriptive Statistics</h2>
<div id="distribution-of-pricerating-by-wine-type" class="section level3">
<h3>Distribution of price/rating by wine type</h3>
<p>Question: What is the distribution of prices/rating among four types of wine? Is at least one wine type’s price/rating different from the others?</p>
<p>To explore this question, we first look at the wine with price lower than $100 since there are many very expensive wine and it is hard to show the distribution with a very long tail. We want to graph a boxplot of prices for each of the four types of wine: red, rose, sparkling and white. It is interesting to see that red and sparking wine have similar distribution with mean price around $27. The prices of rose are lower than the other three types and are mostly round $10~$20. In addition, we run an ANOVA test to find if at least one of the wine types’e price is different from the others.</p>
<p>We repeat the same process to ratings. The results for price and ratings are both significant. Therefore, we can conclude that there is at least one wine type’s price/rating significantly different from the others.</p>
<p>This inform further modeling to see if we can based on the type of wine to predict its price and rating.</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(type),
         price &lt;= 100) %&gt;% 
  ggplot(aes(x = type, y = price, color = type)) +
  geom_boxplot()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-4-1.png" width="90%" /></p>
<pre class="r"><code>wine_price = 
  wine_df %&gt;% 
  filter(price &lt;= 100)
res.aov &lt;- aov(price ~ type, data = wine_price)
summary(res.aov)</code></pre>
<pre><code>##                 Df   Sum Sq Mean Sq F value Pr(&gt;F)    
## type             3  2948351  982784    2791 &lt;2e-16 ***
## Residuals   106267 37418807     352                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 11338 observations deleted due to missingness</code></pre>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(type)) %&gt;% 
  rename(rating = points) %&gt;% 
  ggplot(aes(x = type, y = rating, color = type)) +
  geom_boxplot()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-4-2.png" width="90%" /></p>
<pre class="r"><code>res.aov &lt;- aov(points ~ type, data = wine_df)
summary(res.aov)</code></pre>
<pre><code>##                 Df  Sum Sq Mean Sq F value Pr(&gt;F)    
## type             3   16593    5531   597.3 &lt;2e-16 ***
## Residuals   117650 1089353       9                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 12317 observations deleted due to missingness</code></pre>
</div>
<div id="distribution-of-pricerating-by-region" class="section level3">
<h3>Distribution of price/rating by region</h3>
<pre class="r"><code>y &lt;- list(
  title = &quot;Mean Price&quot;
)
wine_df %&gt;% 
  filter(!is.na(price)) %&gt;% 
  group_by(country) %&gt;% 
  summarise(mean = mean(price)) %&gt;% 
  mutate(country = fct_reorder(country, mean),
         mean = round(mean, 2),
        text_label=str_c(&quot;Country:&quot;, country, &quot;\nmean price:&quot;, mean)) %&gt;% 
  plot_ly(
  x = ~country, y = ~mean, color = ~country, text = ~text_label, 
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) %&gt;% 
  layout(yaxis = y)</code></pre>
<div id="htmlwidget-1046c82e2e469cd31598" style="width:90%;height:345.6px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1046c82e2e469cd31598">{"x":{"visdat":{"d85312d4af46":["function () ","plotlyVisDat"]},"cur_data":"d85312d4af46","attrs":{"d85312d4af46":{"x":{},"y":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"Mean Price"},"xaxis":{"domain":[0,1],"automargin":true,"title":"country","type":"category","categoryorder":"array","categoryarray":["Ukraine","Bosnia and Herzegovina","India","Armenia","Bulgaria","Romania","Macedonia","Slovakia","Cyprus","Moldova","China","Peru","Georgia","Morocco","Chile","Greece","Luxembourg","Brazil","Czech Republic","Serbia","Argentina","Turkey","South Africa","Slovenia","Croatia","Portugal","Uruguay","Mexico","New Zealand","Spain","Lebanon","Austria","Israel","Australia","Canada","US","Italy","Hungary","France","Germany","England","Switzerland"]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Ukraine"],"y":[9.21],"text":"Country:Ukraine<br />mean price:9.21","type":"bar","name":"Ukraine","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bosnia and Herzegovina"],"y":[12.5],"text":"Country:Bosnia and Herzegovina<br />mean price:12.5","type":"bar","name":"Bosnia and Herzegovina","marker":{"color":"rgba(70,10,93,1)","line":{"color":"rgba(70,10,93,1)"}},"textfont":{"color":"rgba(70,10,93,1)"},"error_y":{"color":"rgba(70,10,93,1)"},"error_x":{"color":"rgba(70,10,93,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["India"],"y":[13.33],"text":"Country:India<br />mean price:13.33","type":"bar","name":"India","marker":{"color":"rgba(71,19,102,1)","line":{"color":"rgba(71,19,102,1)"}},"textfont":{"color":"rgba(71,19,102,1)"},"error_y":{"color":"rgba(71,19,102,1)"},"error_x":{"color":"rgba(71,19,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Armenia"],"y":[14.5],"text":"Country:Armenia<br />mean price:14.5","type":"bar","name":"Armenia","marker":{"color":"rgba(72,28,110,1)","line":{"color":"rgba(72,28,110,1)"}},"textfont":{"color":"rgba(72,28,110,1)"},"error_y":{"color":"rgba(72,28,110,1)"},"error_x":{"color":"rgba(72,28,110,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bulgaria"],"y":[14.65],"text":"Country:Bulgaria<br />mean price:14.65","type":"bar","name":"Bulgaria","marker":{"color":"rgba(72,36,117,1)","line":{"color":"rgba(72,36,117,1)"}},"textfont":{"color":"rgba(72,36,117,1)"},"error_y":{"color":"rgba(72,36,117,1)"},"error_x":{"color":"rgba(72,36,117,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Romania"],"y":[15.24],"text":"Country:Romania<br />mean price:15.24","type":"bar","name":"Romania","marker":{"color":"rgba(71,44,122,1)","line":{"color":"rgba(71,44,122,1)"}},"textfont":{"color":"rgba(71,44,122,1)"},"error_y":{"color":"rgba(71,44,122,1)"},"error_x":{"color":"rgba(71,44,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Macedonia"],"y":[15.58],"text":"Country:Macedonia<br />mean price:15.58","type":"bar","name":"Macedonia","marker":{"color":"rgba(70,51,127,1)","line":{"color":"rgba(70,51,127,1)"}},"textfont":{"color":"rgba(70,51,127,1)"},"error_y":{"color":"rgba(70,51,127,1)"},"error_x":{"color":"rgba(70,51,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Slovakia"],"y":[16],"text":"Country:Slovakia<br />mean price:16","type":"bar","name":"Slovakia","marker":{"color":"rgba(68,59,132,1)","line":{"color":"rgba(68,59,132,1)"}},"textfont":{"color":"rgba(68,59,132,1)"},"error_y":{"color":"rgba(68,59,132,1)"},"error_x":{"color":"rgba(68,59,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Cyprus"],"y":[16.27],"text":"Country:Cyprus<br />mean price:16.27","type":"bar","name":"Cyprus","marker":{"color":"rgba(65,66,135,1)","line":{"color":"rgba(65,66,135,1)"}},"textfont":{"color":"rgba(65,66,135,1)"},"error_y":{"color":"rgba(65,66,135,1)"},"error_x":{"color":"rgba(65,66,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Moldova"],"y":[16.75],"text":"Country:Moldova<br />mean price:16.75","type":"bar","name":"Moldova","marker":{"color":"rgba(62,73,137,1)","line":{"color":"rgba(62,73,137,1)"}},"textfont":{"color":"rgba(62,73,137,1)"},"error_y":{"color":"rgba(62,73,137,1)"},"error_x":{"color":"rgba(62,73,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["China"],"y":[18],"text":"Country:China<br />mean price:18","type":"bar","name":"China","marker":{"color":"rgba(60,80,139,1)","line":{"color":"rgba(60,80,139,1)"}},"textfont":{"color":"rgba(60,80,139,1)"},"error_y":{"color":"rgba(60,80,139,1)"},"error_x":{"color":"rgba(60,80,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Peru"],"y":[18.06],"text":"Country:Peru<br />mean price:18.06","type":"bar","name":"Peru","marker":{"color":"rgba(57,87,140,1)","line":{"color":"rgba(57,87,140,1)"}},"textfont":{"color":"rgba(57,87,140,1)"},"error_y":{"color":"rgba(57,87,140,1)"},"error_x":{"color":"rgba(57,87,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Georgia"],"y":[19.32],"text":"Country:Georgia<br />mean price:19.32","type":"bar","name":"Georgia","marker":{"color":"rgba(53,94,141,1)","line":{"color":"rgba(53,94,141,1)"}},"textfont":{"color":"rgba(53,94,141,1)"},"error_y":{"color":"rgba(53,94,141,1)"},"error_x":{"color":"rgba(53,94,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morocco"],"y":[19.5],"text":"Country:Morocco<br />mean price:19.5","type":"bar","name":"Morocco","marker":{"color":"rgba(50,100,142,1)","line":{"color":"rgba(50,100,142,1)"}},"textfont":{"color":"rgba(50,100,142,1)"},"error_y":{"color":"rgba(50,100,142,1)"},"error_x":{"color":"rgba(50,100,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Chile"],"y":[20.79],"text":"Country:Chile<br />mean price:20.79","type":"bar","name":"Chile","marker":{"color":"rgba(48,106,142,1)","line":{"color":"rgba(48,106,142,1)"}},"textfont":{"color":"rgba(48,106,142,1)"},"error_y":{"color":"rgba(48,106,142,1)"},"error_x":{"color":"rgba(48,106,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Greece"],"y":[22.36],"text":"Country:Greece<br />mean price:22.36","type":"bar","name":"Greece","marker":{"color":"rgba(45,112,142,1)","line":{"color":"rgba(45,112,142,1)"}},"textfont":{"color":"rgba(45,112,142,1)"},"error_y":{"color":"rgba(45,112,142,1)"},"error_x":{"color":"rgba(45,112,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Luxembourg"],"y":[23.33],"text":"Country:Luxembourg<br />mean price:23.33","type":"bar","name":"Luxembourg","marker":{"color":"rgba(42,118,142,1)","line":{"color":"rgba(42,118,142,1)"}},"textfont":{"color":"rgba(42,118,142,1)"},"error_y":{"color":"rgba(42,118,142,1)"},"error_x":{"color":"rgba(42,118,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Brazil"],"y":[23.77],"text":"Country:Brazil<br />mean price:23.77","type":"bar","name":"Brazil","marker":{"color":"rgba(40,124,142,1)","line":{"color":"rgba(40,124,142,1)"}},"textfont":{"color":"rgba(40,124,142,1)"},"error_y":{"color":"rgba(40,124,142,1)"},"error_x":{"color":"rgba(40,124,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic"],"y":[24.25],"text":"Country:Czech Republic<br />mean price:24.25","type":"bar","name":"Czech Republic","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Serbia"],"y":[24.5],"text":"Country:Serbia<br />mean price:24.5","type":"bar","name":"Serbia","marker":{"color":"rgba(36,135,142,1)","line":{"color":"rgba(36,135,142,1)"}},"textfont":{"color":"rgba(36,135,142,1)"},"error_y":{"color":"rgba(36,135,142,1)"},"error_x":{"color":"rgba(36,135,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Argentina"],"y":[24.51],"text":"Country:Argentina<br />mean price:24.51","type":"bar","name":"Argentina","marker":{"color":"rgba(34,141,141,1)","line":{"color":"rgba(34,141,141,1)"}},"textfont":{"color":"rgba(34,141,141,1)"},"error_y":{"color":"rgba(34,141,141,1)"},"error_x":{"color":"rgba(34,141,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Turkey"],"y":[24.63],"text":"Country:Turkey<br />mean price:24.63","type":"bar","name":"Turkey","marker":{"color":"rgba(32,147,140,1)","line":{"color":"rgba(32,147,140,1)"}},"textfont":{"color":"rgba(32,147,140,1)"},"error_y":{"color":"rgba(32,147,140,1)"},"error_x":{"color":"rgba(32,147,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Africa"],"y":[24.67],"text":"Country:South Africa<br />mean price:24.67","type":"bar","name":"South Africa","marker":{"color":"rgba(31,153,138,1)","line":{"color":"rgba(31,153,138,1)"}},"textfont":{"color":"rgba(31,153,138,1)"},"error_y":{"color":"rgba(31,153,138,1)"},"error_x":{"color":"rgba(31,153,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Slovenia"],"y":[24.81],"text":"Country:Slovenia<br />mean price:24.81","type":"bar","name":"Slovenia","marker":{"color":"rgba(31,159,136,1)","line":{"color":"rgba(31,159,136,1)"}},"textfont":{"color":"rgba(31,159,136,1)"},"error_y":{"color":"rgba(31,159,136,1)"},"error_x":{"color":"rgba(31,159,136,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Croatia"],"y":[25.45],"text":"Country:Croatia<br />mean price:25.45","type":"bar","name":"Croatia","marker":{"color":"rgba(32,164,134,1)","line":{"color":"rgba(32,164,134,1)"}},"textfont":{"color":"rgba(32,164,134,1)"},"error_y":{"color":"rgba(32,164,134,1)"},"error_x":{"color":"rgba(32,164,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Portugal"],"y":[26.22],"text":"Country:Portugal<br />mean price:26.22","type":"bar","name":"Portugal","marker":{"color":"rgba(36,170,131,1)","line":{"color":"rgba(36,170,131,1)"}},"textfont":{"color":"rgba(36,170,131,1)"},"error_y":{"color":"rgba(36,170,131,1)"},"error_x":{"color":"rgba(36,170,131,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Uruguay"],"y":[26.4],"text":"Country:Uruguay<br />mean price:26.4","type":"bar","name":"Uruguay","marker":{"color":"rgba(42,176,127,1)","line":{"color":"rgba(42,176,127,1)"}},"textfont":{"color":"rgba(42,176,127,1)"},"error_y":{"color":"rgba(42,176,127,1)"},"error_x":{"color":"rgba(42,176,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mexico"],"y":[26.79],"text":"Country:Mexico<br />mean price:26.79","type":"bar","name":"Mexico","marker":{"color":"rgba(50,182,122,1)","line":{"color":"rgba(50,182,122,1)"}},"textfont":{"color":"rgba(50,182,122,1)"},"error_y":{"color":"rgba(50,182,122,1)"},"error_x":{"color":"rgba(50,182,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Zealand"],"y":[26.93],"text":"Country:New Zealand<br />mean price:26.93","type":"bar","name":"New Zealand","marker":{"color":"rgba(59,187,117,1)","line":{"color":"rgba(59,187,117,1)"}},"textfont":{"color":"rgba(59,187,117,1)"},"error_y":{"color":"rgba(59,187,117,1)"},"error_x":{"color":"rgba(59,187,117,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Spain"],"y":[28.22],"text":"Country:Spain<br />mean price:28.22","type":"bar","name":"Spain","marker":{"color":"rgba(71,192,111,1)","line":{"color":"rgba(71,192,111,1)"}},"textfont":{"color":"rgba(71,192,111,1)"},"error_y":{"color":"rgba(71,192,111,1)"},"error_x":{"color":"rgba(71,192,111,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lebanon"],"y":[30.69],"text":"Country:Lebanon<br />mean price:30.69","type":"bar","name":"Lebanon","marker":{"color":"rgba(83,197,104,1)","line":{"color":"rgba(83,197,104,1)"}},"textfont":{"color":"rgba(83,197,104,1)"},"error_y":{"color":"rgba(83,197,104,1)"},"error_x":{"color":"rgba(83,197,104,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Austria"],"y":[30.76],"text":"Country:Austria<br />mean price:30.76","type":"bar","name":"Austria","marker":{"color":"rgba(96,202,96,1)","line":{"color":"rgba(96,202,96,1)"}},"textfont":{"color":"rgba(96,202,96,1)"},"error_y":{"color":"rgba(96,202,96,1)"},"error_x":{"color":"rgba(96,202,96,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel"],"y":[31.77],"text":"Country:Israel<br />mean price:31.77","type":"bar","name":"Israel","marker":{"color":"rgba(110,206,88,1)","line":{"color":"rgba(110,206,88,1)"}},"textfont":{"color":"rgba(110,206,88,1)"},"error_y":{"color":"rgba(110,206,88,1)"},"error_x":{"color":"rgba(110,206,88,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Australia"],"y":[35.44],"text":"Country:Australia<br />mean price:35.44","type":"bar","name":"Australia","marker":{"color":"rgba(125,210,80,1)","line":{"color":"rgba(125,210,80,1)"}},"textfont":{"color":"rgba(125,210,80,1)"},"error_y":{"color":"rgba(125,210,80,1)"},"error_x":{"color":"rgba(125,210,80,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada"],"y":[35.71],"text":"Country:Canada<br />mean price:35.71","type":"bar","name":"Canada","marker":{"color":"rgba(140,214,70,1)","line":{"color":"rgba(140,214,70,1)"}},"textfont":{"color":"rgba(140,214,70,1)"},"error_y":{"color":"rgba(140,214,70,1)"},"error_x":{"color":"rgba(140,214,70,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["US"],"y":[36.57],"text":"Country:US<br />mean price:36.57","type":"bar","name":"US","marker":{"color":"rgba(156,217,59,1)","line":{"color":"rgba(156,217,59,1)"}},"textfont":{"color":"rgba(156,217,59,1)"},"error_y":{"color":"rgba(156,217,59,1)"},"error_x":{"color":"rgba(156,217,59,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Italy"],"y":[39.66],"text":"Country:Italy<br />mean price:39.66","type":"bar","name":"Italy","marker":{"color":"rgba(173,220,48,1)","line":{"color":"rgba(173,220,48,1)"}},"textfont":{"color":"rgba(173,220,48,1)"},"error_y":{"color":"rgba(173,220,48,1)"},"error_x":{"color":"rgba(173,220,48,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Hungary"],"y":[40.65],"text":"Country:Hungary<br />mean price:40.65","type":"bar","name":"Hungary","marker":{"color":"rgba(189,223,38,1)","line":{"color":"rgba(189,223,38,1)"}},"textfont":{"color":"rgba(189,223,38,1)"},"error_y":{"color":"rgba(189,223,38,1)"},"error_x":{"color":"rgba(189,223,38,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["France"],"y":[41.14],"text":"Country:France<br />mean price:41.14","type":"bar","name":"France","marker":{"color":"rgba(206,225,29,1)","line":{"color":"rgba(206,225,29,1)"}},"textfont":{"color":"rgba(206,225,29,1)"},"error_y":{"color":"rgba(206,225,29,1)"},"error_x":{"color":"rgba(206,225,29,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Germany"],"y":[42.26],"text":"Country:Germany<br />mean price:42.26","type":"bar","name":"Germany","marker":{"color":"rgba(222,227,24,1)","line":{"color":"rgba(222,227,24,1)"}},"textfont":{"color":"rgba(222,227,24,1)"},"error_y":{"color":"rgba(222,227,24,1)"},"error_x":{"color":"rgba(222,227,24,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["England"],"y":[51.68],"text":"Country:England<br />mean price:51.68","type":"bar","name":"England","marker":{"color":"rgba(238,229,28,1)","line":{"color":"rgba(238,229,28,1)"}},"textfont":{"color":"rgba(238,229,28,1)"},"error_y":{"color":"rgba(238,229,28,1)"},"error_x":{"color":"rgba(238,229,28,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Switzerland"],"y":[85.29],"text":"Country:Switzerland<br />mean price:85.29","type":"bar","name":"Switzerland","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>y &lt;- list(
  title = &quot;Mean rating&quot;
)
wine_df %&gt;% 
  filter(!is.na(points)) %&gt;% 
  group_by(country) %&gt;% 
  summarise(mean = mean(points)) %&gt;% 
  mutate(country = fct_reorder(country, mean),
         avg_rating = round(mean, 2),
        text_label=str_c(&quot;Country:&quot;, country, &quot;\nmean rating:&quot;, mean)) %&gt;% 
  plot_ly(
  x = ~country, y = ~avg_rating, color = ~country, text = ~text_label, 
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) %&gt;% 
  layout(yaxis = list(range = c(80,95)))</code></pre>
<div id="htmlwidget-9640a85d7b116499667f" style="width:90%;height:345.6px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9640a85d7b116499667f">{"x":{"visdat":{"d853493f2652":["function () ","plotlyVisDat"]},"cur_data":"d853493f2652","attrs":{"d853493f2652":{"x":{},"y":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"range":[80,95],"title":"avg_rating"},"xaxis":{"domain":[0,1],"automargin":true,"title":"country","type":"category","categoryorder":"array","categoryarray":["Peru","Egypt","Ukraine","Brazil","Mexico","Romania","Chile","Bosnia and Herzegovina","Argentina","Uruguay","Macedonia","Slovakia","Cyprus","Moldova","Croatia","Czech Republic","Greece","Spain","Armenia","Serbia","Lebanon","Georgia","Bulgaria","South Africa","Slovenia","Turkey","Portugal","New Zealand","Israel","Italy","US","Morocco","Switzerland","Australia","Luxembourg","France","China","Hungary","Canada","Germany","Austria","India","England"]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Peru"],"y":[83.56],"text":"Country:Peru<br />mean rating:83.5625","type":"bar","name":"Peru","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Egypt"],"y":[84],"text":"Country:Egypt<br />mean rating:84","type":"bar","name":"Egypt","marker":{"color":"rgba(70,10,93,1)","line":{"color":"rgba(70,10,93,1)"}},"textfont":{"color":"rgba(70,10,93,1)"},"error_y":{"color":"rgba(70,10,93,1)"},"error_x":{"color":"rgba(70,10,93,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ukraine"],"y":[84.07],"text":"Country:Ukraine<br />mean rating:84.0714285714286","type":"bar","name":"Ukraine","marker":{"color":"rgba(71,19,101,1)","line":{"color":"rgba(71,19,101,1)"}},"textfont":{"color":"rgba(71,19,101,1)"},"error_y":{"color":"rgba(71,19,101,1)"},"error_x":{"color":"rgba(71,19,101,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Brazil"],"y":[84.67],"text":"Country:Brazil<br />mean rating:84.6730769230769","type":"bar","name":"Brazil","marker":{"color":"rgba(72,27,109,1)","line":{"color":"rgba(72,27,109,1)"}},"textfont":{"color":"rgba(72,27,109,1)"},"error_y":{"color":"rgba(72,27,109,1)"},"error_x":{"color":"rgba(72,27,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mexico"],"y":[85.26],"text":"Country:Mexico<br />mean rating:85.2571428571429","type":"bar","name":"Mexico","marker":{"color":"rgba(72,35,116,1)","line":{"color":"rgba(72,35,116,1)"}},"textfont":{"color":"rgba(72,35,116,1)"},"error_y":{"color":"rgba(72,35,116,1)"},"error_x":{"color":"rgba(72,35,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Romania"],"y":[86.4],"text":"Country:Romania<br />mean rating:86.4","type":"bar","name":"Romania","marker":{"color":"rgba(71,43,122,1)","line":{"color":"rgba(71,43,122,1)"}},"textfont":{"color":"rgba(71,43,122,1)"},"error_y":{"color":"rgba(71,43,122,1)"},"error_x":{"color":"rgba(71,43,122,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Chile"],"y":[86.49],"text":"Country:Chile<br />mean rating:86.4935152057245","type":"bar","name":"Chile","marker":{"color":"rgba(70,50,126,1)","line":{"color":"rgba(70,50,126,1)"}},"textfont":{"color":"rgba(70,50,126,1)"},"error_y":{"color":"rgba(70,50,126,1)"},"error_x":{"color":"rgba(70,50,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bosnia and Herzegovina"],"y":[86.5],"text":"Country:Bosnia and Herzegovina<br />mean rating:86.5","type":"bar","name":"Bosnia and Herzegovina","marker":{"color":"rgba(68,58,131,1)","line":{"color":"rgba(68,58,131,1)"}},"textfont":{"color":"rgba(68,58,131,1)"},"error_y":{"color":"rgba(68,58,131,1)"},"error_x":{"color":"rgba(68,58,131,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Argentina"],"y":[86.71],"text":"Country:Argentina<br />mean rating:86.7102631578947","type":"bar","name":"Argentina","marker":{"color":"rgba(66,65,134,1)","line":{"color":"rgba(66,65,134,1)"}},"textfont":{"color":"rgba(66,65,134,1)"},"error_y":{"color":"rgba(66,65,134,1)"},"error_x":{"color":"rgba(66,65,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Uruguay"],"y":[86.75],"text":"Country:Uruguay<br />mean rating:86.7522935779816","type":"bar","name":"Uruguay","marker":{"color":"rgba(63,72,137,1)","line":{"color":"rgba(63,72,137,1)"}},"textfont":{"color":"rgba(63,72,137,1)"},"error_y":{"color":"rgba(63,72,137,1)"},"error_x":{"color":"rgba(63,72,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Macedonia"],"y":[86.83],"text":"Country:Macedonia<br />mean rating:86.8333333333333","type":"bar","name":"Macedonia","marker":{"color":"rgba(60,79,138,1)","line":{"color":"rgba(60,79,138,1)"}},"textfont":{"color":"rgba(60,79,138,1)"},"error_y":{"color":"rgba(60,79,138,1)"},"error_x":{"color":"rgba(60,79,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Slovakia"],"y":[87],"text":"Country:Slovakia<br />mean rating:87","type":"bar","name":"Slovakia","marker":{"color":"rgba(57,85,140,1)","line":{"color":"rgba(57,85,140,1)"}},"textfont":{"color":"rgba(57,85,140,1)"},"error_y":{"color":"rgba(57,85,140,1)"},"error_x":{"color":"rgba(57,85,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Cyprus"],"y":[87.18],"text":"Country:Cyprus<br />mean rating:87.1818181818182","type":"bar","name":"Cyprus","marker":{"color":"rgba(54,92,141,1)","line":{"color":"rgba(54,92,141,1)"}},"textfont":{"color":"rgba(54,92,141,1)"},"error_y":{"color":"rgba(54,92,141,1)"},"error_x":{"color":"rgba(54,92,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Moldova"],"y":[87.2],"text":"Country:Moldova<br />mean rating:87.2033898305085","type":"bar","name":"Moldova","marker":{"color":"rgba(51,98,141,1)","line":{"color":"rgba(51,98,141,1)"}},"textfont":{"color":"rgba(51,98,141,1)"},"error_y":{"color":"rgba(51,98,141,1)"},"error_x":{"color":"rgba(51,98,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Croatia"],"y":[87.22],"text":"Country:Croatia<br />mean rating:87.2191780821918","type":"bar","name":"Croatia","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Czech Republic"],"y":[87.25],"text":"Country:Czech Republic<br />mean rating:87.25","type":"bar","name":"Czech Republic","marker":{"color":"rgba(46,110,142,1)","line":{"color":"rgba(46,110,142,1)"}},"textfont":{"color":"rgba(46,110,142,1)"},"error_y":{"color":"rgba(46,110,142,1)"},"error_x":{"color":"rgba(46,110,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Greece"],"y":[87.28],"text":"Country:Greece<br />mean rating:87.2832618025751","type":"bar","name":"Greece","marker":{"color":"rgba(44,115,142,1)","line":{"color":"rgba(44,115,142,1)"}},"textfont":{"color":"rgba(44,115,142,1)"},"error_y":{"color":"rgba(44,115,142,1)"},"error_x":{"color":"rgba(44,115,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Spain"],"y":[87.29],"text":"Country:Spain<br />mean rating:87.2883370955606","type":"bar","name":"Spain","marker":{"color":"rgba(41,121,142,1)","line":{"color":"rgba(41,121,142,1)"}},"textfont":{"color":"rgba(41,121,142,1)"},"error_y":{"color":"rgba(41,121,142,1)"},"error_x":{"color":"rgba(41,121,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Armenia"],"y":[87.5],"text":"Country:Armenia<br />mean rating:87.5","type":"bar","name":"Armenia","marker":{"color":"rgba(39,127,142,1)","line":{"color":"rgba(39,127,142,1)"}},"textfont":{"color":"rgba(39,127,142,1)"},"error_y":{"color":"rgba(39,127,142,1)"},"error_x":{"color":"rgba(39,127,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Serbia"],"y":[87.5],"text":"Country:Serbia<br />mean rating:87.5","type":"bar","name":"Serbia","marker":{"color":"rgba(37,132,142,1)","line":{"color":"rgba(37,132,142,1)"}},"textfont":{"color":"rgba(37,132,142,1)"},"error_y":{"color":"rgba(37,132,142,1)"},"error_x":{"color":"rgba(37,132,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lebanon"],"y":[87.69],"text":"Country:Lebanon<br />mean rating:87.6857142857143","type":"bar","name":"Lebanon","marker":{"color":"rgba(35,138,141,1)","line":{"color":"rgba(35,138,141,1)"}},"textfont":{"color":"rgba(35,138,141,1)"},"error_y":{"color":"rgba(35,138,141,1)"},"error_x":{"color":"rgba(35,138,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Georgia"],"y":[87.69],"text":"Country:Georgia<br />mean rating:87.6860465116279","type":"bar","name":"Georgia","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bulgaria"],"y":[87.94],"text":"Country:Bulgaria<br />mean rating:87.936170212766","type":"bar","name":"Bulgaria","marker":{"color":"rgba(31,150,139,1)","line":{"color":"rgba(31,150,139,1)"}},"textfont":{"color":"rgba(31,150,139,1)"},"error_y":{"color":"rgba(31,150,139,1)"},"error_x":{"color":"rgba(31,150,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["South Africa"],"y":[88.06],"text":"Country:South Africa<br />mean rating:88.0563882940757","type":"bar","name":"South Africa","marker":{"color":"rgba(30,156,137,1)","line":{"color":"rgba(30,156,137,1)"}},"textfont":{"color":"rgba(30,156,137,1)"},"error_y":{"color":"rgba(30,156,137,1)"},"error_x":{"color":"rgba(30,156,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Slovenia"],"y":[88.07],"text":"Country:Slovenia<br />mean rating:88.0689655172414","type":"bar","name":"Slovenia","marker":{"color":"rgba(31,161,135,1)","line":{"color":"rgba(31,161,135,1)"}},"textfont":{"color":"rgba(31,161,135,1)"},"error_y":{"color":"rgba(31,161,135,1)"},"error_x":{"color":"rgba(31,161,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Turkey"],"y":[88.09],"text":"Country:Turkey<br />mean rating:88.0888888888889","type":"bar","name":"Turkey","marker":{"color":"rgba(34,167,133,1)","line":{"color":"rgba(34,167,133,1)"}},"textfont":{"color":"rgba(34,167,133,1)"},"error_y":{"color":"rgba(34,167,133,1)"},"error_x":{"color":"rgba(34,167,133,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Portugal"],"y":[88.25],"text":"Country:Portugal<br />mean rating:88.2502196450536","type":"bar","name":"Portugal","marker":{"color":"rgba(38,173,129,1)","line":{"color":"rgba(38,173,129,1)"}},"textfont":{"color":"rgba(38,173,129,1)"},"error_y":{"color":"rgba(38,173,129,1)"},"error_x":{"color":"rgba(38,173,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["New Zealand"],"y":[88.3],"text":"Country:New Zealand<br />mean rating:88.3030303030303","type":"bar","name":"New Zealand","marker":{"color":"rgba(45,178,125,1)","line":{"color":"rgba(45,178,125,1)"}},"textfont":{"color":"rgba(45,178,125,1)"},"error_y":{"color":"rgba(45,178,125,1)"},"error_x":{"color":"rgba(45,178,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Israel"],"y":[88.47],"text":"Country:Israel<br />mean rating:88.4712871287129","type":"bar","name":"Israel","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Italy"],"y":[88.56],"text":"Country:Italy<br />mean rating:88.5622313203685","type":"bar","name":"Italy","marker":{"color":"rgba(63,188,115,1)","line":{"color":"rgba(63,188,115,1)"}},"textfont":{"color":"rgba(63,188,115,1)"},"error_y":{"color":"rgba(63,188,115,1)"},"error_x":{"color":"rgba(63,188,115,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["US"],"y":[88.56],"text":"Country:US<br />mean rating:88.5637200939381","type":"bar","name":"US","marker":{"color":"rgba(74,193,109,1)","line":{"color":"rgba(74,193,109,1)"}},"textfont":{"color":"rgba(74,193,109,1)"},"error_y":{"color":"rgba(74,193,109,1)"},"error_x":{"color":"rgba(74,193,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Morocco"],"y":[88.57],"text":"Country:Morocco<br />mean rating:88.5714285714286","type":"bar","name":"Morocco","marker":{"color":"rgba(86,198,103,1)","line":{"color":"rgba(86,198,103,1)"}},"textfont":{"color":"rgba(86,198,103,1)"},"error_y":{"color":"rgba(86,198,103,1)"},"error_x":{"color":"rgba(86,198,103,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Switzerland"],"y":[88.57],"text":"Country:Switzerland<br />mean rating:88.5714285714286","type":"bar","name":"Switzerland","marker":{"color":"rgba(100,203,95,1)","line":{"color":"rgba(100,203,95,1)"}},"textfont":{"color":"rgba(100,203,95,1)"},"error_y":{"color":"rgba(100,203,95,1)"},"error_x":{"color":"rgba(100,203,95,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Australia"],"y":[88.58],"text":"Country:Australia<br />mean rating:88.5805066552168","type":"bar","name":"Australia","marker":{"color":"rgba(113,207,87,1)","line":{"color":"rgba(113,207,87,1)"}},"textfont":{"color":"rgba(113,207,87,1)"},"error_y":{"color":"rgba(113,207,87,1)"},"error_x":{"color":"rgba(113,207,87,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Luxembourg"],"y":[88.67],"text":"Country:Luxembourg<br />mean rating:88.6666666666667","type":"bar","name":"Luxembourg","marker":{"color":"rgba(128,211,78,1)","line":{"color":"rgba(128,211,78,1)"}},"textfont":{"color":"rgba(128,211,78,1)"},"error_y":{"color":"rgba(128,211,78,1)"},"error_x":{"color":"rgba(128,211,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["France"],"y":[88.85],"text":"Country:France<br />mean rating:88.8451093106414","type":"bar","name":"France","marker":{"color":"rgba(143,214,68,1)","line":{"color":"rgba(143,214,68,1)"}},"textfont":{"color":"rgba(143,214,68,1)"},"error_y":{"color":"rgba(143,214,68,1)"},"error_x":{"color":"rgba(143,214,68,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["China"],"y":[89],"text":"Country:China<br />mean rating:89","type":"bar","name":"China","marker":{"color":"rgba(159,218,58,1)","line":{"color":"rgba(159,218,58,1)"}},"textfont":{"color":"rgba(159,218,58,1)"},"error_y":{"color":"rgba(159,218,58,1)"},"error_x":{"color":"rgba(159,218,58,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Hungary"],"y":[89.19],"text":"Country:Hungary<br />mean rating:89.1917808219178","type":"bar","name":"Hungary","marker":{"color":"rgba(175,221,47,1)","line":{"color":"rgba(175,221,47,1)"}},"textfont":{"color":"rgba(175,221,47,1)"},"error_y":{"color":"rgba(175,221,47,1)"},"error_x":{"color":"rgba(175,221,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Canada"],"y":[89.37],"text":"Country:Canada<br />mean rating:89.3696498054475","type":"bar","name":"Canada","marker":{"color":"rgba(191,223,37,1)","line":{"color":"rgba(191,223,37,1)"}},"textfont":{"color":"rgba(191,223,37,1)"},"error_y":{"color":"rgba(191,223,37,1)"},"error_x":{"color":"rgba(191,223,37,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Germany"],"y":[89.85],"text":"Country:Germany<br />mean rating:89.8517321016166","type":"bar","name":"Germany","marker":{"color":"rgba(207,225,28,1)","line":{"color":"rgba(207,225,28,1)"}},"textfont":{"color":"rgba(207,225,28,1)"},"error_y":{"color":"rgba(207,225,28,1)"},"error_x":{"color":"rgba(207,225,28,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Austria"],"y":[90.1],"text":"Country:Austria<br />mean rating:90.1013452914798","type":"bar","name":"Austria","marker":{"color":"rgba(223,227,24,1)","line":{"color":"rgba(223,227,24,1)"}},"textfont":{"color":"rgba(223,227,24,1)"},"error_y":{"color":"rgba(223,227,24,1)"},"error_x":{"color":"rgba(223,227,24,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["India"],"y":[90.22],"text":"Country:India<br />mean rating:90.2222222222222","type":"bar","name":"India","marker":{"color":"rgba(239,229,28,1)","line":{"color":"rgba(239,229,28,1)"}},"textfont":{"color":"rgba(239,229,28,1)"},"error_y":{"color":"rgba(239,229,28,1)"},"error_x":{"color":"rgba(239,229,28,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["England"],"y":[91.58],"text":"Country:England<br />mean rating:91.5810810810811","type":"bar","name":"England","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="trend-of-pricerating-over-time" class="section level3">
<h3>Trend of price/rating over time</h3>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(price),
         !is.na(type),
         year &gt; 2000) %&gt;% 
  group_by(year,type) %&gt;% 
  summarise(mean = mean(price)) %&gt;% 
  mutate(mean = round(mean, 2)) %&gt;% 
  ggplot(aes(x = year, y = mean, color = type))+
  geom_point()+
  geom_line() +
  labs(y = &quot;Mean price&quot;,
      x = &quot;Year&quot;,
      title = &quot;change in mean price by wine type in 21 century&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(points),
         !is.na(type),
         year &gt; 2000) %&gt;% 
  group_by(year,type) %&gt;% 
  summarise(mean = mean(points)) %&gt;% 
  mutate(mean = round(mean, 2)) %&gt;% 
  ggplot(aes(x = year, y = mean, color = type))+
  geom_point()+
  geom_line() +
  labs(y = &quot;Mean rating&quot;,
      x = &quot;Year&quot;,
      title = &quot;change in mean ratings by wine type in 21 century&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-6-2.png" width="90%" /></p>
</div>
<div id="average-wine-ratings-by-taster." class="section level3">
<h3>Average wine ratings by taster.</h3>
<pre class="r"><code>y &lt;- list(
  title = &quot;Mean ratings&quot;
)

  wine_df %&gt;% 
  filter(!is.na(points)) %&gt;% 
  group_by(taster_name) %&gt;% 
  summarise(mean = mean(points)) %&gt;% 
  mutate(taster_name = fct_reorder(taster_name, mean),
         mean = round(mean, 2),
        text_label=str_c(&quot;Taster:&quot;, taster_name, &quot;\nmean rating:&quot;, mean)) %&gt;% 
  plot_ly(
  x = ~taster_name, y = ~mean, color = ~taster_name, text = ~text_label, 
  type = &quot;bar&quot;, colors = &quot;viridis&quot;) %&gt;% 
 layout(yaxis = list(range = c(80,95)))</code></pre>
<div id="htmlwidget-14a126142ce55f9d3370" style="width:90%;height:345.6px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-14a126142ce55f9d3370">{"x":{"visdat":{"d853603d0b71":["function () ","plotlyVisDat"]},"cur_data":"d853603d0b71","attrs":{"d853603d0b71":{"x":{},"y":{},"text":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"range":[80,95],"title":"mean"},"xaxis":{"domain":[0,1],"automargin":true,"title":"taster_name","type":"category","categoryorder":"array","categoryarray":["Alexander Peartree","Carrie Dykes","Susan Kostrzewa","Fiona Adams","Michael Schachner","Lauren Buzzeo","Christina Pickard","Jeff Jenssen","Anna Lee C. Iijima","Joe Czerwinski","Jim Gordon","Roger Voss","Sean P. Sullivan","Kerin O’Keefe","Paul Gregutt","Mike DeSimone","Virginie Boone","Matt Kettmann","Anne Krebiehl MW"]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Alexander Peartree"],"y":[85.86],"text":"Taster:Alexander Peartree<br />mean rating:85.86","type":"bar","name":"Alexander Peartree","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Carrie Dykes"],"y":[86.4],"text":"Taster:Carrie Dykes<br />mean rating:86.4","type":"bar","name":"Carrie Dykes","marker":{"color":"rgba(72,22,104,1)","line":{"color":"rgba(72,22,104,1)"}},"textfont":{"color":"rgba(72,22,104,1)"},"error_y":{"color":"rgba(72,22,104,1)"},"error_x":{"color":"rgba(72,22,104,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Susan Kostrzewa"],"y":[86.61],"text":"Taster:Susan Kostrzewa<br />mean rating:86.61","type":"bar","name":"Susan Kostrzewa","marker":{"color":"rgba(72,40,120,1)","line":{"color":"rgba(72,40,120,1)"}},"textfont":{"color":"rgba(72,40,120,1)"},"error_y":{"color":"rgba(72,40,120,1)"},"error_x":{"color":"rgba(72,40,120,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Fiona Adams"],"y":[86.89],"text":"Taster:Fiona Adams<br />mean rating:86.89","type":"bar","name":"Fiona Adams","marker":{"color":"rgba(68,58,131,1)","line":{"color":"rgba(68,58,131,1)"}},"textfont":{"color":"rgba(68,58,131,1)"},"error_y":{"color":"rgba(68,58,131,1)"},"error_x":{"color":"rgba(68,58,131,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Michael Schachner"],"y":[86.91],"text":"Taster:Michael Schachner<br />mean rating:86.91","type":"bar","name":"Michael Schachner","marker":{"color":"rgba(62,74,137,1)","line":{"color":"rgba(62,74,137,1)"}},"textfont":{"color":"rgba(62,74,137,1)"},"error_y":{"color":"rgba(62,74,137,1)"},"error_x":{"color":"rgba(62,74,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Lauren Buzzeo"],"y":[87.74],"text":"Taster:Lauren Buzzeo<br />mean rating:87.74","type":"bar","name":"Lauren Buzzeo","marker":{"color":"rgba(55,90,140,1)","line":{"color":"rgba(55,90,140,1)"}},"textfont":{"color":"rgba(55,90,140,1)"},"error_y":{"color":"rgba(55,90,140,1)"},"error_x":{"color":"rgba(55,90,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Christina Pickard"],"y":[87.83],"text":"Taster:Christina Pickard<br />mean rating:87.83","type":"bar","name":"Christina Pickard","marker":{"color":"rgba(49,104,142,1)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,1)"},"error_y":{"color":"rgba(49,104,142,1)"},"error_x":{"color":"rgba(49,104,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jeff Jenssen"],"y":[88.32],"text":"Taster:Jeff Jenssen<br />mean rating:88.32","type":"bar","name":"Jeff Jenssen","marker":{"color":"rgba(43,117,142,1)","line":{"color":"rgba(43,117,142,1)"}},"textfont":{"color":"rgba(43,117,142,1)"},"error_y":{"color":"rgba(43,117,142,1)"},"error_x":{"color":"rgba(43,117,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Anna Lee C. Iijima"],"y":[88.42],"text":"Taster:Anna Lee C. Iijima<br />mean rating:88.42","type":"bar","name":"Anna Lee C. Iijima","marker":{"color":"rgba(38,130,142,1)","line":{"color":"rgba(38,130,142,1)"}},"textfont":{"color":"rgba(38,130,142,1)"},"error_y":{"color":"rgba(38,130,142,1)"},"error_x":{"color":"rgba(38,130,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Joe Czerwinski"],"y":[88.54],"text":"Taster:Joe Czerwinski<br />mean rating:88.54","type":"bar","name":"Joe Czerwinski","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jim Gordon"],"y":[88.63],"text":"Taster:Jim Gordon<br />mean rating:88.63","type":"bar","name":"Jim Gordon","marker":{"color":"rgba(31,158,137,1)","line":{"color":"rgba(31,158,137,1)"}},"textfont":{"color":"rgba(31,158,137,1)"},"error_y":{"color":"rgba(31,158,137,1)"},"error_x":{"color":"rgba(31,158,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Roger Voss"],"y":[88.71],"text":"Taster:Roger Voss<br />mean rating:88.71","type":"bar","name":"Roger Voss","marker":{"color":"rgba(37,171,130,1)","line":{"color":"rgba(37,171,130,1)"}},"textfont":{"color":"rgba(37,171,130,1)"},"error_y":{"color":"rgba(37,171,130,1)"},"error_x":{"color":"rgba(37,171,130,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Sean P. Sullivan"],"y":[88.76],"text":"Taster:Sean P. Sullivan<br />mean rating:88.76","type":"bar","name":"Sean P. Sullivan","marker":{"color":"rgba(53,183,121,1)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,1)"},"error_y":{"color":"rgba(53,183,121,1)"},"error_x":{"color":"rgba(53,183,121,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Kerin O’Keefe"],"y":[88.87],"text":"Taster:Kerin O’Keefe<br />mean rating:88.87","type":"bar","name":"Kerin O’Keefe","marker":{"color":"rgba(78,195,107,1)","line":{"color":"rgba(78,195,107,1)"}},"textfont":{"color":"rgba(78,195,107,1)"},"error_y":{"color":"rgba(78,195,107,1)"},"error_x":{"color":"rgba(78,195,107,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Paul Gregutt"],"y":[89.08],"text":"Taster:Paul Gregutt<br />mean rating:89.08","type":"bar","name":"Paul Gregutt","marker":{"color":"rgba(109,205,89,1)","line":{"color":"rgba(109,205,89,1)"}},"textfont":{"color":"rgba(109,205,89,1)"},"error_y":{"color":"rgba(109,205,89,1)"},"error_x":{"color":"rgba(109,205,89,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mike DeSimone"],"y":[89.1],"text":"Taster:Mike DeSimone<br />mean rating:89.1","type":"bar","name":"Mike DeSimone","marker":{"color":"rgba(143,214,68,1)","line":{"color":"rgba(143,214,68,1)"}},"textfont":{"color":"rgba(143,214,68,1)"},"error_y":{"color":"rgba(143,214,68,1)"},"error_x":{"color":"rgba(143,214,68,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Virginie Boone"],"y":[89.21],"text":"Taster:Virginie Boone<br />mean rating:89.21","type":"bar","name":"Virginie Boone","marker":{"color":"rgba(180,222,44,1)","line":{"color":"rgba(180,222,44,1)"}},"textfont":{"color":"rgba(180,222,44,1)"},"error_y":{"color":"rgba(180,222,44,1)"},"error_x":{"color":"rgba(180,222,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Matt Kettmann"],"y":[90.01],"text":"Taster:Matt Kettmann<br />mean rating:90.01","type":"bar","name":"Matt Kettmann","marker":{"color":"rgba(218,227,25,1)","line":{"color":"rgba(218,227,25,1)"}},"textfont":{"color":"rgba(218,227,25,1)"},"error_y":{"color":"rgba(218,227,25,1)"},"error_x":{"color":"rgba(218,227,25,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Anne Krebiehl MW"],"y":[90.56],"text":"Taster:Anne Krebiehl MW<br />mean rating:90.56","type":"bar","name":"Anne Krebiehl MW","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="who-rates-the-highest-price-wine" class="section level3">
<h3>Who rates the highest price wine?</h3>
<p>We want to know the tasters that rated wines with price greater than $800.Most of the most expensive wine are rated by Roger Voss.</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(price &gt;= 800,
         !is.na(taster_name)) %&gt;% 
  group_by(taster_name) %&gt;% 
  summarise(number_of_wine = n()) %&gt;% 
  arrange(desc(number_of_wine)) %&gt;% 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">taster_name</th>
<th align="right">number_of_wine</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Roger Voss</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">Joe Czerwinski</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Anne Krebiehl MW</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Kerin O’Keefe</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Matt Kettmann</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="who-reviews-the-largest-number-of-wines" class="section level3">
<h3>Who reviews the largest number of wines?</h3>
<p>Roger Voss rates most number of wine at WineEthusiast Magazine.</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(taster_name)) %&gt;% 
  group_by(taster_name) %&gt;% 
  summarise(number_of_wine = n()) %&gt;% 
  arrange(desc(number_of_wine)) %&gt;% 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">taster_name</th>
<th align="right">number_of_wine</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Roger Voss</td>
<td align="right">25514</td>
</tr>
<tr class="even">
<td align="left">Michael Schachner</td>
<td align="right">15134</td>
</tr>
<tr class="odd">
<td align="left">Kerin O’Keefe</td>
<td align="right">10776</td>
</tr>
<tr class="even">
<td align="left">Virginie Boone</td>
<td align="right">9537</td>
</tr>
<tr class="odd">
<td align="left">Paul Gregutt</td>
<td align="right">9532</td>
</tr>
<tr class="even">
<td align="left">Matt Kettmann</td>
<td align="right">6332</td>
</tr>
<tr class="odd">
<td align="left">Joe Czerwinski</td>
<td align="right">5147</td>
</tr>
<tr class="even">
<td align="left">Sean P. Sullivan</td>
<td align="right">4966</td>
</tr>
<tr class="odd">
<td align="left">Anna Lee C. Iijima</td>
<td align="right">4415</td>
</tr>
<tr class="even">
<td align="left">Jim Gordon</td>
<td align="right">4177</td>
</tr>
<tr class="odd">
<td align="left">Anne Krebiehl MW</td>
<td align="right">3685</td>
</tr>
<tr class="even">
<td align="left">Lauren Buzzeo</td>
<td align="right">1835</td>
</tr>
<tr class="odd">
<td align="left">Susan Kostrzewa</td>
<td align="right">1085</td>
</tr>
<tr class="even">
<td align="left">Mike DeSimone</td>
<td align="right">514</td>
</tr>
<tr class="odd">
<td align="left">Jeff Jenssen</td>
<td align="right">491</td>
</tr>
<tr class="even">
<td align="left">Alexander Peartree</td>
<td align="right">415</td>
</tr>
<tr class="odd">
<td align="left">Carrie Dykes</td>
<td align="right">139</td>
</tr>
<tr class="even">
<td align="left">Fiona Adams</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">Christina Pickard</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
<p><br><br></p>
</div>
<div id="which-winery-has-the-top-average-ratings-wine" class="section level3">
<h3>Which winery has the top average ratings wine?</h3>
<p>Araujo in the US has the highest average rating of 98. Among the top 10 wineries, four of them are in the US and four of them are in the France.</p>
<pre class="r"><code>wine_df %&gt;% 
  filter(!is.na(winery)) %&gt;% 
  group_by(winery,country) %&gt;% 
  summarise(mean = mean(points)) %&gt;% 
  arrange(desc(mean)) %&gt;% 
  head(n = 10) %&gt;% 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">winery</th>
<th align="left">country</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Araujo</td>
<td align="left">US</td>
<td align="right">98.00000</td>
</tr>
<tr class="even">
<td align="left">Gandona</td>
<td align="left">US</td>
<td align="right">97.00000</td>
</tr>
<tr class="odd">
<td align="left">J.L. Chave</td>
<td align="left">France</td>
<td align="right">97.00000</td>
</tr>
<tr class="even">
<td align="left">Ovid</td>
<td align="left">US</td>
<td align="right">97.00000</td>
</tr>
<tr class="odd">
<td align="left">Standish</td>
<td align="left">Australia</td>
<td align="right">97.00000</td>
</tr>
<tr class="even">
<td align="left">Salon</td>
<td align="left">France</td>
<td align="right">96.80000</td>
</tr>
<tr class="odd">
<td align="left">Tenuta dell’Ornellaia</td>
<td align="left">Italy</td>
<td align="right">96.70000</td>
</tr>
<tr class="even">
<td align="left">Château Pétrus</td>
<td align="left">France</td>
<td align="right">96.66667</td>
</tr>
<tr class="odd">
<td align="left">Barons de Rothschild</td>
<td align="left">France</td>
<td align="right">96.00000</td>
</tr>
<tr class="even">
<td align="left">Bryant Family</td>
<td align="left">US</td>
<td align="right">96.00000</td>
</tr>
</tbody>
</table>
</div>
<div id="differences-of-pricesratings-between-new-world-and-old-world-wine" class="section level3">
<h3>Differences of prices/ratings between new world and old world wine</h3>
<pre class="r"><code>wine_df %&gt;% 
  mutate(new_old = ifelse(new_world == 0, &quot;old_world&quot;, &quot;new_world&quot;)) %&gt;% 
  rename(rating = points) %&gt;% 
  ggplot(aes(x = new_old, y = rating, color =new_old)) +
  geom_boxplot() +
    labs(y = &quot;Mean rating&quot;,
      x = &quot;new vs old world wine&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-11-1.png" width="90%" /></p>
<pre class="r"><code>wine_new_old=
wine_df %&gt;% 
  mutate(new_old = ifelse(new_world == 0, &quot;old_world&quot;, &quot;new_world&quot;))
t.test(price ~ new_old, data = wine_new_old)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  price by new_old
## t = -0.041754, df = 86937, p-value = 0.9667
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.4846275  0.4644101
## sample estimates:
## mean in group new_world mean in group old_world 
##                35.35856                35.36867</code></pre>
<pre class="r"><code>wine_df %&gt;% 
  mutate(new_old = ifelse(new_world == 0, &quot;old_world&quot;, &quot;new_world&quot;)) %&gt;% 
  filter(price &lt;= 100) %&gt;% 
  ggplot(aes(x = new_old, y = price, color =new_old)) +
  geom_boxplot() +
    labs(y = &quot;Mean price&quot;,
      x = &quot;new vs old world wine&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-11-2.png" width="90%" /></p>
<pre class="r"><code>wine_price = 
wine_df %&gt;% 
  mutate(new_old = ifelse(new_world == 0, &quot;old_world&quot;, &quot;new_world&quot;)) %&gt;% 
  filter(price&lt;=100)
t.test(price ~ new_old, data = wine_price)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  price by new_old
## t = 35.395, df = 114502, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  3.741382 4.180033
## sample estimates:
## mean in group new_world mean in group old_world 
##                32.95841                28.99770</code></pre>
</div>
<div id="visualizations" class="section level3">
<h3>Visualizations</h3>
<p>In order to make the US map and World map, we created two separate datasets. The US dataset contained only wines that were from the US.</p>
<pre class="r"><code>wine_tidy_df = 
  read_csv(
  &quot;./wine_data/tidy/wine_all.csv&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre class="r"><code>wine_us = wine_tidy_df %&gt;% 
  filter(country == &quot;US&quot;) %&gt;%
  rename(
    state = province) %&gt;% 
  mutate(
   state = na_if(state, &quot;America&quot;)
 ) %&gt;%
  select(state, points, price) %&gt;% 
  drop_na() %&gt;% 
  group_by(state) %&gt;%
  summarise(
    total = n(),
    avg_rating = mean(points),
    avg_price = mean(price)
  ) %&gt;%
  mutate(
    avg_rating = round(avg_rating, 0), 
    avg_price = round(avg_price, 2)
    ) %&gt;% 
  arrange(desc(total))</code></pre>
<pre class="r"><code>wine_us_missing = wine_tidy_df %&gt;% 
  filter(country == &quot;US&quot;) %&gt;%
  rename(
    state = province) %&gt;% 
  select(state, points, price) %&gt;% 
  mutate(
   state = na_if(state, &quot;America&quot;)
 )

purrr::map(wine_us_missing, ~ sum(is.na(.)))</code></pre>
<pre class="r"><code>wine_by_country = wine_tidy_df %&gt;% 
 mutate(
   country = recode(country, US = &quot;United States&quot;)
 ) %&gt;% 
  select(country, points, price) %&gt;% 
  group_by(country) %&gt;%
  drop_na() %&gt;% 
  summarise(
    total = n(),
    avg_rating = mean(points),
    avg_price = mean(price)
  ) %&gt;%
  mutate(
    avg_rating = round(avg_rating, 0), 
    avg_price = round(avg_price, 2)
    ) %&gt;% 
  arrange(desc(total))</code></pre>
<pre class="r"><code>wine_country_missing = wine_tidy_df %&gt;% 
 mutate(
   country = recode(country, US = &quot;United States&quot;)
 ) %&gt;% 
  select(country, points, price)

purrr::map(wine_country_missing, ~ sum(is.na(.)))</code></pre>
<p>Wines that contained missing prices and state or country information were removed from the dataset. Among all wines made in the US, there were several wines that were labeled as America under state. Those wines were recoded as missing state values and removed from the US dataset. From the US dataset, there were 95 wines that did not have a state value and 239 wines that were missing a price. From the world dataset, there were 63 wines that missing country information and 8996 wines that did not have a price listed. All wines in the dataset had a rating. As the number of missing values was relatively small in comparison to the total number of observations, all wines that contained missing information on wine origin and price were excluded from the map.</p>
<p>For each dataset, we used <code>summarise</code> to generate average ratings and average prices for each state or country, along with the total count of all wines from each state or country. Average ratings was rounded to the nearest whole number and prices were rounded to 2 decimal points.</p>
<pre class="r"><code>states &lt;- states(cb = TRUE)

states %&gt;% 
  leaflet() %&gt;% 
  addTiles() %&gt;% 
  addPolygons(popup = ~NAME)

states_merged_wine &lt;- geo_join(states, wine_us, &quot;NAME&quot;, &quot;state&quot;)

mybins &lt;- c(0,100,1000,8000,10000,40000)
mypal &lt;- colorBin(palette = &quot;Purples&quot;, domain = states_merged_wine$total, na.color = &quot;transparent&quot;, bins = mybins)

states_merged_wine &lt;- subset(states_merged_wine, !is.na(total))

popup &lt;- paste0(
  states_merged_wine$NAME,&quot;&lt;br&gt;&quot;, 
  &quot;Total Wines: &quot;, states_merged_wine$total, &quot;&lt;br&gt;&quot;, 
      &quot;Avg Rating: &quot;, states_merged_wine$avg_rating, &quot;&lt;br&gt;&quot;,
      &quot;Avg Price: $&quot;, states_merged_wine$avg_price,&quot;&lt;br&gt;&quot;
      )

state_map = states_merged_wine %&gt;% 
  leaflet() %&gt;%
  addProviderTiles(&quot;CartoDB.Positron&quot;) %&gt;%
  setView(-98.483330, 38.712046, zoom = 4) %&gt;% 
  addPolygons(
    fillColor = ~mypal(total), 
    fillOpacity = 1.0, 
    weight = 0.4, 
    smoothFactor = 0.2, 
    popup = ~popup) %&gt;% 
  addLegend(pal = mypal, 
            values = states_merged_wine$total, 
            position = &quot;bottomright&quot;, 
            title = &quot;Wines&quot;)</code></pre>
<pre class="r"><code>world_spdf &lt;- readOGR( 
  dsn = paste0(getwd(),&quot;/wine_data/world_shape_file/&quot;) , 
  layer = &quot;TM_WORLD_BORDERS_SIMPL-0.3&quot;,
  verbose = FALSE
)

world_spdf %&gt;% 
  leaflet() %&gt;% 
  addTiles() %&gt;% 
  addPolygons(popup = ~NAME)

countries_merged_wine &lt;- geo_join(world_spdf, wine_by_country, &quot;NAME&quot;, &quot;country&quot;)

world_bins &lt;- c(0,100,1000,10000,20000,30000,60000)
world_pal &lt;- colorBin(palette = &quot;RdPu&quot;, domain = countries_merged_wine$total, na.color = &quot;transparent&quot;, bins = world_bins)

countries_merged_wine &lt;- subset(countries_merged_wine, !is.na(total))

world_popup &lt;- paste0(
  countries_merged_wine$country,&quot;&lt;br&gt;&quot;, 
  &quot;Wines: &quot;, countries_merged_wine$total, &quot;&lt;br&gt;&quot;, 
      &quot;Avg Rating: &quot;, countries_merged_wine$avg_rating, &quot;&lt;br&gt;&quot;,
      &quot;Avg Price: $&quot;, countries_merged_wine$avg_price,&quot;&lt;br&gt;&quot;
      )

world_map_labels = countries_merged_wine %&gt;% 
  leaflet() %&gt;%
  addMapPane(name = &quot;polygons&quot;, zIndex = 410) %&gt;% 
  addMapPane(name = &quot;maplabels&quot;, zIndex = 420) %&gt;% 
  addProviderTiles(&quot;CartoDB.PositronNoLabels&quot;) %&gt;%
  addProviderTiles(&quot;CartoDB.PositronOnlyLabels&quot;, 
                   options = leafletOptions(pane = &quot;maplabels&quot;),
                   group = &quot;labels&quot;) %&gt;%
  setView( lat = 10, lng = 0 , zoom = 2) %&gt;% 
  addPolygons(
    fillColor = ~world_pal(total), 
    fillOpacity = 1.0, 
    group = &quot;country&quot;,
    weight = 0.4, 
    smoothFactor = 0.2, 
    popup = ~world_popup,
    options = leafletOptions(pane = &quot;polygons&quot;)) %&gt;% 
  addLayersControl(overlayGroups = c(&quot;labels&quot;)) %&gt;% 
  addLegend(pal = world_pal, 
            values = countries_merged_wine$total, 
            position = &quot;bottomright&quot;, 
            title = &quot;Wines&quot;)</code></pre>
<p><br><img src="image/us_map.png" alt="us_map" style="width:65%; border:2px solid"><br></p>
<p><br><img src="image/world_map.png" alt="world_map" style="width:65%; border:2px solid"><br></p>
<p>Static Map???</p>
<pre class="r"><code>world_static = map_data(&quot;world&quot;) %&gt;%
  left_join(wine_by_country, by = c(&quot;region&quot; = &quot;country&quot;))

ggplot(data = world_static, 
               mapping = aes(x = long, y = lat, group = group)) +
  geom_polygon(aes(fill = avg_rating)) +
  scale_fill_continuous(low = &quot;rosybrown1&quot;, high = &quot;darkred&quot;, 
                        na.value = &quot;snow2&quot;) +
  coord_map(xlim = c(-180,180), ylim = c(-60, 80)) +
  theme(
    axis.title.x = element_blank(),
    axis.text.x  = element_blank(),
    axis.ticks.x = element_blank(),
    axis.title.y = element_blank(),
    axis.text.y  = element_blank(),
    axis.ticks.y = element_blank(),
    panel.background = element_rect(fill = &quot;white&quot;))</code></pre>
</div>
<div id="summaries-and" class="section level3">
<h3>summaries, and</h3>
</div>
<div id="exploratory-statistical-analyses" class="section level3">
<h3>exploratory statistical analyses</h3>
<p>anova 2-sample ttest.</p>
<p>Justify the steps you took, and show any major changes to your ideas.</p>
<p>#Additional analysis: If you undertake formal statistical analyses, describe these in detail</p>
</div>
<div id="linear-model---multivariate" class="section level3">
<h3>linear model - multivariate</h3>
</div>
<div id="linear-model---name-tbd" class="section level3">
<h3>linear model - name TBD</h3>
</div>
<div id="linear-model---cross-validation" class="section level3">
<h3>linear model - cross validation</h3>
<p>#Discussion: What were your findings? Are they what you expect? What insights into the data can you make?</p>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
